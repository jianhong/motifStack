<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>motifStack Vignette • motifStack</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="motifStack Vignette">
<meta property="og:description" content="motifStack">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">motifStack</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.35.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/motifStack_HTML.html">motifStack Vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="motifStack_HTML_files/header-attrs-2.7/header-attrs.js"></script><script src="motifStack_HTML_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="motifStack_HTML_files/d3-4.4.0/d3.v4.min.js"></script><link href="motifStack_HTML_files/plotWebLogo-0.0.1/d3-plotWebLogo.css" rel="stylesheet">
<script src="motifStack_HTML_files/plotWebLogo-0.0.1/d3-plotWebLogo.js"></script><script src="motifStack_HTML_files/saveSvgAsPng-0.0.1/saveSvgAsPng.js"></script><link href="motifStack_HTML_files/d3-tip-0.8.0/d3-tip.css" rel="stylesheet">
<script src="motifStack_HTML_files/d3-tip-0.8.0/d3-tip.js"></script><script src="motifStack_HTML_files/browseMotifs-binding-1.35.1/browseMotifs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>motifStack Vignette</h1>
                        <h4 class="author">Jianhong Ou, Michael Brodsky, Lihua Julie Zhu</h4>
            
            <h4 class="date">31 March 2021</h4>
      
      
      <div class="hidden name"><code>motifStack_HTML.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>The motifStack package is designed for graphic representation of multiple motifs with different similarity scores. It works with both DNA/RNA sequence motif, affinity logo and amino acid sequence motif. In addition, it provides the flexibility for users to customize the graphic parameters such as the font type and symbol colors.</p>
    </div>
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>A sequence logo, based on information theory, has been widely used as a graphical representation of sequence conservation (aka motif) in multiple amino acid or nucleic acid sequences. Sequence motif represents conserved characteristics such as DNA binding sites, where transcription factors bind, and catalytic sites in enzymes. Although many tools, such as seqlogo<span class="citation"><sup>1</sup></span>, have been developed to create sequence motif and to represent it as individual sequence logo, software tools for depicting the relationship among multiple sequence motifs are still lacking. We developed a flexible and powerful open-source R/Bioconductor package, motifStack, for visualization of the alignment of multiple sequence motifs.</p>
</div>
<div id="examples-of-using-motifstack" class="section level1">
<h1 class="hasAnchor">
<a href="#examples-of-using-motifstack" class="anchor"></a>Examples of using motifStack</h1>
<div id="plot-a-dna-sequence-logo-with-different-fonts-and-colors" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-a-dna-sequence-logo-with-different-fonts-and-colors" class="anchor"></a>plot a DNA sequence logo with different fonts and colors</h2>
<p>Users can select different fonts and colors to draw the sequence logo.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">motifStack</span><span class="op">)</span>
<span class="va">pcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html">find.package</a></span><span class="op">(</span><span class="st">"motifStack"</span><span class="op">)</span>, 
                            <span class="st">"extdata"</span>, <span class="st">"bin_SOLEXA.pcm"</span><span class="op">)</span><span class="op">)</span>
<span class="va">pcm</span> <span class="op">&lt;-</span> <span class="va">pcm</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">pcm</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">pcm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"C"</span>,<span class="st">"G"</span>,<span class="st">"T"</span><span class="op">)</span>
<span class="va">motif</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"pcm"</span>, mat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">pcm</span><span class="op">)</span>, name<span class="op">=</span><span class="st">"bin_SOLEXA"</span><span class="op">)</span>
<span class="co">##pfm object</span>
<span class="co">#motif &lt;- pcm2pfm(pcm)</span>
<span class="co">#motif &lt;- new("pfm", mat=motif, name="bin_SOLEXA")</span>
<span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motif</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/DNAseqLogo-1.png" alt="Plot a DNA sequence logo with different fonts and colors" width="768"><p class="caption">
Plot a DNA sequence logo with different fonts and colors
</p>
</div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#plot the logo with same height</span>
<span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motif</span>, ic.scale<span class="op">=</span><span class="cn">FALSE</span>, ylab<span class="op">=</span><span class="st">"probability"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/DNAseqLogo-2.png" alt="Plot a DNA sequence logo with different fonts and colors" width="768"><p class="caption">
Plot a DNA sequence logo with different fonts and colors
</p>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#try a different font</span>
<span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motif</span>, font<span class="op">=</span><span class="st">"mono,Courier"</span>, fontface<span class="op">=</span><span class="st">"plain"</span><span class="op">)</span> <span class="co"># fontface can be 1=plain, 2=bold, 3=italic, 4=bold italic</span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/DNAseqLogo-3.png" alt="Plot a DNA sequence logo with different fonts and colors" width="768"><p class="caption">
Plot a DNA sequence logo with different fonts and colors
</p>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#try a different font and a different color group</span>
<span class="va">motif</span><span class="op">@</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/colorset.html">colorset</a></span><span class="op">(</span>colorScheme<span class="op">=</span><span class="st">'basepairing'</span><span class="op">)</span>
<span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motif</span>,font<span class="op">=</span><span class="st">"Times"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/DNAseqLogo-4.png" alt="Plot a DNA sequence logo with different fonts and colors" width="768"><p class="caption">
Plot a DNA sequence logo with different fonts and colors
</p>
</div>
</div>
<div id="plot-sequence-logo-with-markers" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-sequence-logo-with-markers" class="anchor"></a>plot sequence logo with markers</h2>
<p>If you assign markers slot by a list of <code>marker</code> object, markers can be plotted in the figure. There are three type of markers, “rect”, “line” and “text”.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">markerRect</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"marker"</span>, type<span class="op">=</span><span class="st">"rect"</span>, start<span class="op">=</span><span class="fl">6</span>, stop<span class="op">=</span><span class="fl">7</span>, gp<span class="op">=</span><span class="fu">gpar</span><span class="op">(</span>lty<span class="op">=</span><span class="fl">2</span>, fill<span class="op">=</span><span class="cn">NA</span>, col<span class="op">=</span><span class="st">"orange"</span><span class="op">)</span><span class="op">)</span>
<span class="va">markerLine</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"marker"</span>, type<span class="op">=</span><span class="st">"line"</span>, start<span class="op">=</span><span class="fl">2</span>, stop<span class="op">=</span><span class="fl">7</span>, gp<span class="op">=</span><span class="fu">gpar</span><span class="op">(</span>lwd<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">)</span>
<span class="va">markerText</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"marker"</span>, type<span class="op">=</span><span class="st">"text"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, 
                  label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"*"</span>, <span class="st">"core"</span><span class="op">)</span>, gp<span class="op">=</span><span class="fu">gpar</span><span class="op">(</span>cex<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">)</span>
<span class="va">motif</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"pcm"</span>, mat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">pcm</span><span class="op">)</span>, name<span class="op">=</span><span class="st">"bin_SOLEXA"</span>, 
             markers<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">markerRect</span>, <span class="va">markerLine</span>, <span class="va">markerText</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motif</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/seqLogoMarkers-1.png" alt="Plot a DNA sequence logo with markers" width="768"><p class="caption">
Plot a DNA sequence logo with markers
</p>
</div>
</div>
<div id="plot-a-rna-sequence-logo" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-a-rna-sequence-logo" class="anchor"></a>plot a RNA sequence logo</h2>
<p>To plot a RNA sequence logo, you only need to change the rowname of the matrix from “T” to “U” as follows.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rna</span> <span class="op">&lt;-</span> <span class="va">pcm</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">rna</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"U"</span>
<span class="va">motif</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"pcm"</span>, mat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">rna</span><span class="op">)</span>, name<span class="op">=</span><span class="st">"RNA_motif"</span><span class="op">)</span>
<span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motif</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/RNAseqLogo-1.png" alt="Plot an RNA sequence logo" width="576"><p class="caption">
Plot an RNA sequence logo
</p>
</div>
</div>
<div id="plot-an-amino-acid-sequence-logo" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-an-amino-acid-sequence-logo" class="anchor"></a>plot an amino acid sequence logo</h2>
<p>Given that motifStack allows to use any letters as symbols, it can also be used to draw amino acid sequence logos.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">motifStack</span><span class="op">)</span>
<span class="va">protein</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html">find.package</a></span><span class="op">(</span><span class="st">"motifStack"</span><span class="op">)</span>,<span class="st">"extdata"</span>,<span class="st">"cap.txt"</span><span class="op">)</span><span class="op">)</span>
<span class="va">protein</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">protein</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span>
<span class="va">motif</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/pcm-class.html">pcm2pfm</a></span><span class="op">(</span><span class="va">protein</span><span class="op">)</span>
<span class="va">motif</span><span class="op">&lt;-</span><span class="fu">new</span><span class="op">(</span><span class="st">"pfm"</span>, mat<span class="op">=</span><span class="va">motif</span>, name<span class="op">=</span><span class="st">"CAP"</span>, 
            color<span class="op">=</span><span class="fu"><a href="../reference/colorset.html">colorset</a></span><span class="op">(</span>alphabet<span class="op">=</span><span class="st">"AA"</span>,colorScheme<span class="op">=</span><span class="st">"chemistry"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motif</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/AAseqLogo-1.png" alt="Plot an sequence logo with any symbols as you want such as amino acid sequence logo" width="576"><p class="caption">
Plot an sequence logo with any symbols as you want such as amino acid sequence logo
</p>
</div>
</div>
<div id="plot-an-affinity-logo" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-an-affinity-logo" class="anchor"></a>plot an affinity logo</h2>
<p>It can also be used to draw affinity logos given a position specific affinity matrix (PSAM) as described by Foat et al..<span class="citation"><sup>2</sup></span></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">motifStack</span><span class="op">)</span>
<span class="va">motif</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="fl">.846</span>, <span class="fl">.631</span>, <span class="fl">.593</span>, <span class="fl">.000</span>, <span class="fl">.000</span>, <span class="fl">.000</span>, <span class="fl">.434</span>, <span class="fl">.410</span>, <span class="fl">1.00</span>, <span class="fl">.655</span>, <span class="fl">.284</span>, <span class="fl">.000</span>, <span class="fl">.000</span>, <span class="fl">.771</span>, <span class="fl">.640</span>, <span class="fl">.961</span>,
    <span class="fl">.625</span>, <span class="fl">.679</span>, <span class="fl">.773</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">.000</span>, <span class="fl">.573</span>, <span class="fl">.238</span>, <span class="fl">.397</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">.000</span>, <span class="fl">.298</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">.996</span>,
    <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">.228</span>, <span class="fl">.000</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">.597</span>, <span class="fl">.622</span>, <span class="fl">.630</span>, <span class="fl">.000</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">.871</span>, <span class="fl">.617</span>, <span class="fl">1.00</span>,
    <span class="fl">.701</span>, <span class="fl">.513</span>, <span class="fl">.658</span>, <span class="fl">.000</span>, <span class="fl">.000</span>, <span class="fl">.247</span>, <span class="fl">.542</span>, <span class="fl">1.00</span>, <span class="fl">.718</span>, <span class="fl">.686</span>, <span class="fl">.000</span>, <span class="fl">.000</span>, <span class="fl">.000</span>, <span class="fl">.595</span>, <span class="fl">.437</span>, <span class="fl">.970</span>
  <span class="op">)</span>, nrow<span class="op">=</span><span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">motif</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span><span class="op">)</span>
<span class="va">motif</span><span class="op">&lt;-</span><span class="fu">new</span><span class="op">(</span><span class="st">"psam"</span>, mat<span class="op">=</span><span class="va">motif</span>, name<span class="op">=</span><span class="st">"affinity logo"</span>, 
           markers<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu">new</span><span class="op">(</span><span class="st">"marker"</span>, type<span class="op">=</span><span class="st">"rect"</span>,
                            start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">11</span><span class="op">)</span>, stop<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">13</span><span class="op">)</span>,
                            gp<span class="op">=</span><span class="fu">gpar</span><span class="op">(</span>col<span class="op">=</span><span class="st">"#009E73"</span>, fill<span class="op">=</span><span class="cn">NA</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motif</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/affinityLogo-1.png" alt="Plot an affinity logo" width="576"><p class="caption">
Plot an affinity logo
</p>
</div>
</div>
<div id="plot-sequence-logo-stack" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-sequence-logo-stack" class="anchor"></a>plot sequence logo stack</h2>
<p>To show multiple motifs on the same canvas as a sequence logo stack, the distance of motifs need to be calculated first. Previously, MotIV<span class="citation"><sup>3</sup></span>::<code>motifDistances</code> ( R implementation of STAMP<span class="citation"><sup>4</sup></span>) is used to calculate the distance. However, The MotIV package were dropped from Bioconductor 3_12. Currently, by default, R implementation of matalign is used. After alignment, users can use <code>plotMotifLogoStack</code>, <code>plotMotifLogoStackWithTree</code> or <code>plotMotifStackWithRadialPhylog</code> to draw sequence logos in different layouts. To make it easy to use, we integrated different functionalities into one workflow function named as <code>motifStack</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">motifStack</span><span class="op">)</span>
<span class="co">#####Input#####</span>
<span class="va">motifs</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/importMatrix.html">importMatrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html">find.package</a></span><span class="op">(</span><span class="st">"motifStack"</span><span class="op">)</span>,
                                   <span class="st">"extdata"</span><span class="op">)</span>,<span class="st">"pcm$"</span>, 
                         full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>

<span class="co">## plot stacks</span>
<span class="fu"><a href="../reference/motifStack.html">motifStack</a></span><span class="op">(</span><span class="va">motifs</span>, layout<span class="op">=</span><span class="st">"stack"</span>, ncex<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/logostack-1.png" alt="Plot motifs with sequence logo stack style" width="384"><p class="caption">
Plot motifs with sequence logo stack style
</p>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rnaMotifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DNAmotifToRNAmotif.html">DNAmotifToRNAmotif</a></span><span class="op">(</span><span class="va">motifs</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">rnaMotifs</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "bin_SOLEXA"   "fd64A_SOLEXA" "fkh_NAR"      "foxo_SOLEXA"  "FoxP_SOLEXA" 
## [6] "slp1_SOLEXA"  "slp2_SOLEXA"</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/motifStack.html">motifStack</a></span><span class="op">(</span><span class="va">rnaMotifs</span>, layout <span class="op">=</span> <span class="st">"stack"</span>, 
           reorder<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co">## we can also use reorder=FALSE to keep the order of input. </span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/rnalogostack-1.png" alt="Plot RNA motifs with sequence logo stack style" width="384"><p class="caption">
Plot RNA motifs with sequence logo stack style
</p>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">motif2</span> <span class="op">&lt;-</span> <span class="va">motif</span>
<span class="va">motif2</span><span class="op">$</span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="va">motif</span><span class="op">$</span><span class="va">mat</span><span class="op">[</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span>
<span class="va">motif2</span><span class="op">$</span><span class="va">name</span> <span class="op">&lt;-</span> <span class="st">"logo2"</span>
<span class="va">psamMotifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">motif</span>, <span class="va">motif2</span><span class="op">)</span>
<span class="fu"><a href="../reference/motifStack.html">motifStack</a></span><span class="op">(</span><span class="va">psamMotifs</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/logostack2-1.png" alt="Plot affinity logos with sequence logo stack style" width="384"><p class="caption">
Plot affinity logos with sequence logo stack style
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## plot stacks with hierarchical tree</span>
<span class="fu"><a href="../reference/motifStack.html">motifStack</a></span><span class="op">(</span><span class="va">motifs</span>, layout<span class="op">=</span><span class="st">"tree"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/treestack-1.png" alt="Sequence logo stack with hierarchical cluster tree" width="480"><p class="caption">
Sequence logo stack with hierarchical cluster tree
</p>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## When the number of motifs is too much to be shown in a vertical stack, </span>
<span class="co">## motifStack can draw them in a radial style.</span>
<span class="co">## random sample from MotifDb</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"MotifDb"</span><span class="op">)</span>
<span class="va">matrix.fly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MotifDb/man/query.html">query</a></span><span class="op">(</span><span class="va">MotifDb</span>, <span class="st">"Dmelanogaster"</span><span class="op">)</span>
<span class="va">motifs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">matrix.fly</span><span class="op">)</span>
<span class="co">## use data from FlyFactorSurvey</span>
<span class="va">motifs2</span> <span class="op">&lt;-</span> <span class="va">motifs2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Dmelanogaster\\-FlyFactorSurvey\\-"</span>,
                         <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">motifs2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="co">## format the names</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">motifs2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"Dmelanogaster_FlyFactorSurvey_"</span>, <span class="st">""</span>,
                       <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"_FBgn\\d+$"</span>, <span class="st">""</span>,
                            <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"[^a-zA-Z0-9]"</span>,<span class="st">"_"</span>,
                                 <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"(_\\d+)+$"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">motifs2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">motifs2</span> <span class="op">&lt;-</span> <span class="va">motifs2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">motifs2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="va">pfms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">motifs2</span>, <span class="fl">30</span><span class="op">)</span>
<span class="co">## creat a list of object of pfm </span>
<span class="va">motifs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html">mapply</a></span><span class="op">(</span><span class="va">pfms</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">pfms</span><span class="op">)</span>, FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">.ele</span>, <span class="va">.name</span><span class="op">)</span><span class="op">{</span>
  <span class="fu">new</span><span class="op">(</span><span class="st">"pfm"</span>,mat<span class="op">=</span><span class="va">.ele</span>, name<span class="op">=</span><span class="va">.name</span><span class="op">)</span><span class="op">}</span>, SIMPLIFY <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">## trim the motifs</span>
<span class="va">motifs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">motifs2</span>, <span class="va">trimMotif</span>, t<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span>
<span class="co">## setting colors</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span>
<span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">"Set3"</span><span class="op">)</span>
<span class="co">## plot logo stack with radial style</span>
<span class="fu"><a href="../reference/motifStack.html">motifStack</a></span><span class="op">(</span><span class="va">motifs2</span>, layout<span class="op">=</span><span class="st">"radialPhylog"</span>, 
           circle<span class="op">=</span><span class="fl">0.3</span>, cleaves <span class="op">=</span> <span class="fl">0.2</span>, 
           clabel.leaves <span class="op">=</span> <span class="fl">0.5</span>, 
           col.bg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">color</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, col.bg.alpha<span class="op">=</span><span class="fl">0.3</span>, 
           col.leaves<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">color</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,
           col.inner.label.circle<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">color</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, 
           inner.label.circle.width<span class="op">=</span><span class="fl">0.05</span>,
           col.outer.label.circle<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">color</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, 
           outer.label.circle.width<span class="op">=</span><span class="fl">0.02</span>, 
           circle.motif<span class="op">=</span><span class="fl">1.2</span>,
           angle<span class="op">=</span><span class="fl">350</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/radialstack-1.png" alt="Plot motifs in a radial style when the number of motifs is too much to be shown in a vertical stack" width="576"><p class="caption">
Plot motifs in a radial style when the number of motifs is too much to be shown in a vertical stack
</p>
</div>
</div>
<div id="plot-a-sequence-logo-cloud" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-a-sequence-logo-cloud" class="anchor"></a>plot a sequence logo cloud</h2>
<p>We can also plot a sequence logo cloud for DNA motifs.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## assign groups for motifs</span>
<span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"group"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">groups</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">pfms</span><span class="op">)</span>
<span class="co">## assign group colors</span>
<span class="va">group.col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"Set3"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">group.col</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"group"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="co">## create a list of pfm objects</span>
<span class="va">pfms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html">mapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">pfms</span><span class="op">)</span>, <span class="va">pfms</span>, FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">.ele</span>, <span class="va">.pfm</span><span class="op">)</span><span class="op">{</span>
  <span class="fu">new</span><span class="op">(</span><span class="st">"pfm"</span>,mat<span class="op">=</span><span class="va">.pfm</span>, name<span class="op">=</span><span class="va">.ele</span><span class="op">)</span><span class="op">}</span>
               ,SIMPLIFY <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">## use matalign to calculate the distances of motifs</span>
<span class="va">hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clusterMotifs.html">clusterMotifs</a></span><span class="op">(</span><span class="va">pfms</span><span class="op">)</span>
<span class="co">## convert the hclust to phylog object</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/">ade4</a></span><span class="op">)</span>
<span class="va">phylog</span> <span class="op">&lt;-</span> <span class="fu">ade4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/newick2phylog.html">hclust2phylog</a></span><span class="op">(</span><span class="va">hc</span><span class="op">)</span>
<span class="co">## reorder the pfms by the order of hclust</span>
<span class="va">leaves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">phylog</span><span class="op">$</span><span class="va">leaves</span><span class="op">)</span>
<span class="va">pfms</span> <span class="op">&lt;-</span> <span class="va">pfms</span><span class="op">[</span><span class="va">leaves</span><span class="op">]</span>
<span class="co">## extract the motif signatures</span>
<span class="va">motifSig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/motifSignature.html">motifSignature</a></span><span class="op">(</span><span class="va">pfms</span>, <span class="va">phylog</span>, cutoffPval<span class="op">=</span><span class="fl">0.0001</span>, min.freq<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="co">## draw the motifs with a tag-cloud style.</span>
<span class="fu"><a href="../reference/motifCloud.html">motifCloud</a></span><span class="op">(</span><span class="va">motifSig</span>, scale<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">.5</span><span class="op">)</span>, 
           layout<span class="op">=</span><span class="st">"rectangles"</span>, 
           group.col<span class="op">=</span><span class="va">group.col</span>, 
           groups<span class="op">=</span><span class="va">groups</span>, 
           draw.legend<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/motifCloud-1.png" alt="Sequence logo cloud with rectangle packing layout" width="576"><p class="caption">
Sequence logo cloud with rectangle packing layout
</p>
</div>
</div>
<div id="plot-grouped-sequence-logo" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-grouped-sequence-logo" class="anchor"></a>plot grouped sequence logo</h2>
<p>Grouped sequence logo can also be plotted in radial phylogeny tree style.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## get the signatures from object of motifSignature</span>
<span class="va">sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/motifSig-class.html">signatures</a></span><span class="op">(</span><span class="va">motifSig</span><span class="op">)</span>
<span class="co">## set the inner-circle color for each signature</span>
<span class="va">gpCol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/motifSig-class.html">sigColor</a></span><span class="op">(</span><span class="va">motifSig</span><span class="op">)</span>
<span class="co">## plot the logo stack with radial style.</span>
<span class="fu"><a href="../reference/plotMotifStackWithRadialPhylog.html">plotMotifStackWithRadialPhylog</a></span><span class="op">(</span>phylog<span class="op">=</span><span class="va">phylog</span>, pfms<span class="op">=</span><span class="va">sig</span>, 
                              circle<span class="op">=</span><span class="fl">0.4</span>, cleaves <span class="op">=</span> <span class="fl">0.3</span>, 
                              clabel.leaves <span class="op">=</span> <span class="fl">0.5</span>, 
                              col.bg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">color</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, col.bg.alpha<span class="op">=</span><span class="fl">0.3</span>, 
                              col.leaves<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">color</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,
                              col.inner.label.circle<span class="op">=</span><span class="va">gpCol</span>, 
                              inner.label.circle.width<span class="op">=</span><span class="fl">0.03</span>,
                              angle<span class="op">=</span><span class="fl">350</span>, circle.motif<span class="op">=</span><span class="fl">1.2</span>, 
                              motifScale<span class="op">=</span><span class="st">"logarithmic"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/motifRadialPhylog-1.png" alt="Grouped sequence logo with radialPhylog style layout" width="576"><p class="caption">
Grouped sequence logo with radialPhylog style layout
</p>
</div>
</div>
<div id="motifcircos" class="section level2">
<h2 class="hasAnchor">
<a href="#motifcircos" class="anchor"></a>motifCircos</h2>
<p>We can also plot it with circos style. In circos style, we can plot two group of motifs and with multiple color rings.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## plot the logo stack with cirsoc style.</span>
<span class="fu"><a href="../reference/motifCircos.html">motifCircos</a></span><span class="op">(</span>phylog<span class="op">=</span><span class="va">phylog</span>, pfms<span class="op">=</span><span class="va">pfms</span>, pfms2<span class="op">=</span><span class="va">sig</span>, 
            col.tree.bg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">color</span>, each<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, col.tree.bg.alpha<span class="op">=</span><span class="fl">0.3</span>, 
            col.leaves<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">color</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,
            col.inner.label.circle<span class="op">=</span><span class="va">gpCol</span>, 
            inner.label.circle.width<span class="op">=</span><span class="fl">0.03</span>,
            col.outer.label.circle<span class="op">=</span><span class="va">gpCol</span>, 
            outer.label.circle.width<span class="op">=</span><span class="fl">0.03</span>,
            r.rings<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span><span class="op">)</span>, 
            col.rings<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">colors</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">30</span><span class="op">)</span>, 
                           <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">colors</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">30</span><span class="op">)</span>, 
                           <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">colors</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span>,
            angle<span class="op">=</span><span class="fl">350</span>, motifScale<span class="op">=</span><span class="st">"logarithmic"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/motifCircos-1.png" alt="Grouped sequence logo with circos style layout" width="576"><p class="caption">
Grouped sequence logo with circos style layout
</p>
</div>
</div>
<div id="motifpiles" class="section level2">
<h2 class="hasAnchor">
<a href="#motifpiles" class="anchor"></a>motifPiles</h2>
<p>We can also plot the motifs in pile style. In pile style, we can plot two group of motifs with multiple types of annotation, for example heatmap. The <em>col.anno</em> parameter should be set as a named list.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## plot the logo stack with heatmap.</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>A<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>, B<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>, C<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>, D<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span>
<span class="va">map2col</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">pal</span><span class="op">)</span><span class="op">{</span>
  <span class="va">rg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="va">pal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/findInterval.html">findInterval</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">rg</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">rg</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">pal</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, 
                   all.inside <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span>
<span class="op">}</span>
<span class="va">dl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">map2col</span>, pal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">heat.colors</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="co">## alignment of the pfms, this step will make the motif logos occupy </span>
<span class="co">## more space. Users can skip this alignment to see the difference.</span>
<span class="va">pfmsAligned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DNAmotifAlignment.html">DNAmotifAlignment</a></span><span class="op">(</span><span class="va">pfms</span><span class="op">)</span>
<span class="co">## plot motifs</span>
<span class="fu"><a href="../reference/motifPiles.html">motifPiles</a></span><span class="op">(</span>phylog<span class="op">=</span><span class="va">phylog</span>, pfms<span class="op">=</span><span class="va">pfmsAligned</span>, 
            col.tree<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">color</span>, each<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,
            col.leaves<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">color</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,
            col.pfms2<span class="op">=</span><span class="va">gpCol</span>, 
            r.anno<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">dl</span><span class="op">)</span><span class="op">)</span>, 
            col.anno<span class="op">=</span><span class="va">dl</span>,
            motifScale<span class="op">=</span><span class="st">"logarithmic"</span>,
            plotIndex<span class="op">=</span><span class="cn">TRUE</span>,
            groupDistance<span class="op">=</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/motifPilesHeatmap-1.png" alt="Grouped sequence logo with a heatmap" width="576"><p class="caption">
Grouped sequence logo with a heatmap
</p>
</div>
</div>
</div>
<div id="plot-motifs-with-d3-js" class="section level1">
<h1 class="hasAnchor">
<a href="#plot-motifs-with-d3-js" class="anchor"></a>plot motifs with d3.js</h1>
<p>Interactive plot can be generated using <code>browseMotifs</code> function which leverages the <strong>d3.js</strong> library. All motifs on the plot are draggable and the plot can be easily exported as a <strong>Scalable Vector Graphics (SVG)</strong> file.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/browseMotifs.html">browseMotifs</a></span><span class="op">(</span>pfms <span class="op">=</span> <span class="va">pfms</span>, phylog <span class="op">=</span> <span class="va">phylog</span>, layout<span class="op">=</span><span class="st">"tree"</span>, yaxis <span class="op">=</span> <span class="cn">FALSE</span>, baseWidth<span class="op">=</span><span class="fl">6</span>, baseHeight <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-45757eac486c5b4d0c44" style="width:768px;height:768px;" class="browseMotifs html-widget"></div>
<script type="application/json" data-for="htmlwidget-45757eac486c5b4d0c44">{"x":{"elements":{"name":"Root","children":[{"name":"Int27","children":[{"name":"Int17","children":[{"name":"CG31782_F9_11_SANGER_5","motif":[[[0.714285714285714,0,0.142857142857143,0.142857142857143],[0,0.285714285714286,0.571428571428571,0.142857142857143],[0,0.285714285714286,0.571428571428571,0.142857142857143],[0.142857142857143,0,0,0.857142857142857],[0,1,0,0],[0.714285714285714,0,0,0.285714285714286],[0,1,0,0],[0,1,0,0],[1,0,0,0],[0.285714285714286,0.714285714285714,0,0],[0,0.714285714285714,0,0.285714285714286],[0.857142857142857,0,0,0.142857142857143],[0.857142857142857,0,0.142857142857143,0],[0.833333333333333,0,0,0.166666666666667]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":90,"height":15,"xaxis":true,"yaxis":false},{"name":"CG4360_F1_3_SANGER_2_5","motif":[[[0.625,0.375,0,0],[0,1,0,0],[1,0,0,0],[0.875,0,0.125,0],[0,1,0,0],[1,0,0,0],[1,0,0,0],[0.125,0.875,0,0],[0.875,0,0,0.125],[0.875,0,0,0.125],[0.25,0.375,0.375,0],[0.375,0.625,0,0],[0,0.625,0.375,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":84,"height":15,"xaxis":true,"yaxis":false}]},{"name":"Int25","children":[{"name":"Int16","children":[{"name":"Int9","children":[{"name":"Bteb2_SOLEXA_2_5","motif":[[[0.248322147651007,0.140939597315436,0.305369127516779,0.305369127516779],[0.316455696202532,0.208860759493671,0.155063291139241,0.319620253164557],[0.473846153846154,0.0430769230769231,0.335384615384615,0.147692307692308],[0.243076923076923,0.00615384615384615,0.729230769230769,0.0215384615384615],[0.00923076923076923,0,0.766153846153846,0.224615384615385],[0.0153846153846154,0,0.956923076923077,0.0276923076923077],[0.00307692307692308,0,0.938461538461538,0.0584615384615385],[0.00923076923076923,0,0.978461538461538,0.0123076923076923],[0.0246153846153846,0.92,0,0.0553846153846154],[0.00615384615384615,0,0.975384615384615,0.0184615384615385],[0,0,0.338461538461538,0.661538461538462],[0.443076923076923,0.0830769230769231,0.273846153846154,0.2],[0.255384615384615,0.172307692307692,0.175384615384615,0.396923076923077],[0.254658385093168,0.369565217391304,0.164596273291925,0.211180124223602]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":90,"height":15,"xaxis":true,"yaxis":false},{"name":"sr_SANGER_5","motif":[[[0.210526315789474,0.0526315789473684,0.473684210526316,0.263157894736842],[0.105263157894737,0.0526315789473684,0.263157894736842,0.578947368421053],[0.315789473684211,0.0526315789473684,0.526315789473684,0.105263157894737],[0,0.421052631578947,0.263157894736842,0.315789473684211],[0,0,1,0],[0.0526315789473684,0,0.368421052631579,0.578947368421053],[0,0,1,0],[0,0.0526315789473684,0.947368421052632,0],[0,0,1,0],[0.105263157894737,0.736842105263158,0,0.157894736842105],[0.0526315789473684,0,0.842105263157895,0.105263157894737],[0,0.0526315789473684,0.473684210526316,0.473684210526316],[0.0526315789473684,0.210526315789474,0.473684210526316,0.263157894736842],[0.277777777777778,0,0.444444444444444,0.277777777777778]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":90,"height":15,"xaxis":true,"yaxis":false}]},{"name":"Int14","children":[{"name":"Ci_SANGER_5","motif":[[[0.545454545454545,0,0.363636363636364,0.0909090909090909],[0,0,1,0],[0.727272727272727,0.272727272727273,0,0],[0.181818181818182,0.818181818181818,0,0],[0.0909090909090909,0.909090909090909,0,0],[0.727272727272727,0.181818181818182,0,0.0909090909090909],[0,0.909090909090909,0,0.0909090909090909],[0.272727272727273,0.727272727272727,0,0],[0,1,0,0],[0.909090909090909,0,0.0909090909090909,0],[0,0.818181818181818,0.181818181818182,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":72,"height":15,"xaxis":true,"yaxis":false},{"name":"Opa_SANGER_5","motif":[[[0.583333333333333,0.25,0.0833333333333333,0.0833333333333333],[0.166666666666667,0,0.416666666666667,0.416666666666667],[0.333333333333333,0.416666666666667,0.166666666666667,0.0833333333333333],[0.333333333333333,0.583333333333333,0.0833333333333333,0],[0.25,0.75,0,0],[0.0833333333333333,0.75,0.166666666666667,0],[0,1,0,0],[0,0.916666666666667,0.0833333333333333,0],[0,1,0,0],[0.666666666666667,0.25,0.0833333333333333,0],[0,0.916666666666667,0.0833333333333333,0],[0,0.666666666666667,0,0.333333333333333],[0.25,0,0.75,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":84,"height":15,"xaxis":true,"yaxis":false}]}]},{"name":"Int23","children":[{"name":"Int12","children":[{"name":"usp_SANGER_5","motif":[[[0.523809523809524,0.285714285714286,0,0.19047619047619],[0.428571428571429,0,0.571428571428571,0],[0.714285714285714,0,0.285714285714286,0],[0,0,1,0],[0,0,1,0],[0,0,0,1],[0,1,0,0],[1,0,0,0],[0.428571428571429,0.333333333333333,0.0476190476190476,0.19047619047619]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":60,"height":15,"xaxis":true,"yaxis":false},{"name":"Int4","children":[{"name":"tgo_ss_SANGER_5","motif":[[[0,0.1,0,0.9],[0,0,1,0],[0,0.9,0,0.1],[0,0.1,0.9,0],[0,0,0,1],[0,0,1,0],[1,0,0,0],[0,0.8,0,0.2]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false},{"name":"disco_SANGER_5","motif":[[[0.526315789473684,0.0526315789473684,0.105263157894737,0.315789473684211],[0.6,0,0.2,0.2],[0.25,0,0.4,0.35],[0,0,0,1],[0.0526315789473684,0,0.947368421052632,0],[0,0,0,1],[0,1,0,0],[0.9,0,0.05,0.05],[0,1,0,0],[0.25,0.7,0.05,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":66,"height":15,"xaxis":true,"yaxis":false}]}]},{"name":"Int21","children":[{"name":"CG4404_SANGER_5","motif":[[[0.266666666666667,0,0.666666666666667,0.0666666666666667],[0,0.933333333333333,0.0666666666666667,0],[1,0,0,0],[0,0,1,0],[0,0.333333333333333,0,0.666666666666667],[1,0,0,0],[0.666666666666667,0,0,0.333333333333333],[0.4,0.133333333333333,0,0.466666666666667],[0.0666666666666667,0,0.133333333333333,0.8],[0.666666666666667,0.0666666666666667,0.133333333333333,0.133333333333333],[0.333333333333333,0.4,0.266666666666667,0],[0.6,0.266666666666667,0.133333333333333,0],[0,0.333333333333333,0.6,0.0666666666666667],[0.266666666666667,0.533333333333333,0.133333333333333,0.0666666666666667]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":90,"height":15,"xaxis":true,"yaxis":false},{"name":"Int11","children":[{"name":"HLH4C_da_SANGER_5_3","motif":[[[0,1,0,0],[1,0,0,0],[0,1,0,0],[0,1,0,0],[0,0,0,1],[0,0,1,0],[0.333333333333333,0.666666666666667,0,0],[0.25,0.0833333333333333,0.333333333333333,0.333333333333333],[0.0833333333333333,0.833333333333333,0,0.0833333333333333],[0.0909090909090909,0.727272727272727,0.0909090909090909,0.0909090909090909]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":66,"height":15,"xaxis":true,"yaxis":false},{"name":"scrt_SOLEXA_2_5_2","motif":[[[0.467432950191571,0.226053639846743,0.256704980842912,0.0498084291187739],[0.204697986577181,0.61744966442953,0.110738255033557,0.0671140939597315],[0.0716510903426791,0.819314641744548,0.0342679127725857,0.0747663551401869],[0.987538940809969,0,0.00934579439252336,0.00311526479750779],[0,0.993769470404984,0,0.00623052959501558],[0,0.956386292834891,0,0.043613707165109],[0.00311526479750779,0.00623052959501558,0.0124610591900312,0.978193146417445],[0,0,0.987538940809969,0.0124610591900312],[0.00934579439252336,0,0,0.990654205607477],[0.0872274143302181,0.00311526479750779,0.105919003115265,0.803738317757009],[0.11214953271028,0.00934579439252336,0.856697819314642,0.0218068535825545],[0.383177570093458,0.442367601246106,0.0685358255451713,0.105919003115265],[0.383177570093458,0.171339563862928,0.227414330218069,0.218068535825545]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":84,"height":15,"xaxis":true,"yaxis":false}]}]}]}]}]},{"name":"Int28","children":[{"name":"Int20","children":[{"name":"en_FlyReg","motif":[[[0.377358490566038,0.0566037735849057,0.339622641509434,0.226415094339623],[0.0943396226415094,0.283018867924528,0.226415094339623,0.39622641509434],[0.132075471698113,0.132075471698113,0,0.735849056603774],[0.716981132075472,0,0.0754716981132075,0.207547169811321],[0.981132075471698,0,0,0.0188679245283019],[0,0.0377358490566038,0.0377358490566038,0.924528301886792],[0,0.113207547169811,0.264150943396226,0.622641509433962],[0.509433962264151,0,0.490566037735849,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false},{"name":"Int18","children":[{"name":"Int10","children":[{"name":"Zen_Cell","motif":[[[0.1875,0.3125,0.25,0.25],[0.125,0.5,0.25,0.125],[0.125,0.5625,0,0.3125],[0,0,0,1],[1,0,0,0],[1,0,0,0],[0,0,0,1],[0,0,0.6875,0.3125],[1,0,0,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":60,"height":15,"xaxis":true,"yaxis":false},{"name":"CG11085_Cell","motif":[[[0.153846153846154,0.307692307692308,0.153846153846154,0.384615384615385],[0,0.230769230769231,0,0.769230769230769],[0,0,0,1],[1,0,0,0],[1,0,0,0],[0.0769230769230769,0,0,0.923076923076923],[0.153846153846154,0.0769230769230769,0.153846153846154,0.615384615384615],[0.0769230769230769,0,0.923076923076923,0],[0.153846153846154,0.307692307692308,0.461538461538462,0.0769230769230769]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":60,"height":15,"xaxis":true,"yaxis":false}]},{"name":"Int15","children":[{"name":"Lbe_Cell","motif":[[[0.136363636363636,0.227272727272727,0.409090909090909,0.227272727272727],[0.181818181818182,0.272727272727273,0.0909090909090909,0.454545454545455],[0,0,0,1],[1,0,0,0],[1,0,0,0],[0.0454545454545455,0.454545454545455,0.0909090909090909,0.409090909090909],[0.181818181818182,0.227272727272727,0.136363636363636,0.454545454545455],[0.863636363636364,0,0.136363636363636,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false},{"name":"Int6","children":[{"name":"Zen_SOLEXA","motif":[[[0.218527315914489,0.318289786223278,0.26603325415677,0.197149643705463],[0.0973871733966746,0.380047505938242,0.0902612826603325,0.432304038004751],[0.0380047505938242,0.00475059382422803,0,0.957244655581948],[0.973871733966746,0.0261282660332542,0,0],[0.978622327790974,0.0213776722090261,0,0],[0,0.0213776722090261,0,0.978622327790974],[0.0118764845605701,0.00475059382422803,0.498812351543943,0.484560570071259],[0.893111638954869,0.00712589073634204,0.0997624703087886,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false},{"name":"Int5","children":[{"name":"Lbl_Cell","motif":[[[0.217391304347826,0.217391304347826,0.478260869565217,0.0869565217391304],[0.217391304347826,0.434782608695652,0,0.347826086956522],[0,0,0,1],[1,0,0,0],[1,0,0,0],[0,0.217391304347826,0,0.782608695652174],[0.0434782608695652,0.130434782608696,0.304347826086957,0.521739130434783],[0.739130434782609,0,0.260869565217391,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false},{"name":"Int3","children":[{"name":"tup_SOLEXA_10","motif":[[[0.217445225299711,0.266225713104589,0.262091773460107,0.254237288135593],[0.11547811993517,0.357374392220421,0.114667747163695,0.412479740680713],[0.0522690437601297,0,0,0.94773095623987],[0.989465153970827,0,0.0105348460291734,0],[1,0,0,0],[0,0,0.151134521880065,0.848865478119935],[0.0632090761750405,0.0121555915721232,0.437196110210697,0.487439222042139],[0.301189987689783,0.0471891670086172,0.595404185473943,0.056216659827657],[0.34576067348166,0.269392663860493,0.263379434756464,0.121467227901383]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":60,"height":15,"xaxis":true,"yaxis":false},{"name":"Int2","children":[{"name":"Zen2_SOLEXA","motif":[[[0.119391025641026,0.31650641025641,0.104166666666667,0.459935897435897],[0.0721153846153846,0,0,0.927884615384615],[0.967147435897436,0,0.0224358974358974,0.0104166666666667],[1,0,0,0],[0.00240384615384615,0.0649038461538462,0,0.932692307692308],[0.047275641025641,0.0016025641025641,0.462339743589744,0.488782051282051],[0.740384615384615,0,0.25,0.00961538461538462]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":48,"height":15,"xaxis":true,"yaxis":false},{"name":"Int1","children":[{"name":"PhdP_SOLEXA","motif":[[[0.132894736842105,0.298684210526316,0.0881578947368421,0.480263157894737],[0.0223684210526316,0,0,0.977631578947368],[0.980263157894737,0,0,0.0197368421052632],[1,0,0,0],[0,0,0,1],[0.0486842105263158,0.0263157894736842,0.068421052631579,0.856578947368421]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":42,"height":15,"xaxis":true,"yaxis":false},{"name":"Unc4_SOLEXA","motif":[[[0.188541666666667,0.320833333333333,0.23125,0.259375],[0.136458333333333,0.310416666666667,0.117708333333333,0.435416666666667],[0.0208333333333333,0.00729166666666667,0.00833333333333333,0.963541666666667],[0.982291666666667,0.0114583333333333,0.00208333333333333,0.00416666666666667],[0.992708333333333,0.00729166666666667,0,0],[0,0.0145833333333333,0.0291666666666667,0.95625],[0.0364583333333333,0.0208333333333333,0.0885416666666667,0.854166666666667],[0.477083333333333,0.0145833333333333,0.445833333333333,0.0625]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false}]}]}]}]}]}]}]}]},{"name":"Int26","children":[{"name":"Exd_SOLEXA","motif":[[[0.292185730464326,0.172140430351076,0.234428086070215,0.301245753114383],[0.181200453001132,0.194790486976217,0.161947904869762,0.462061155152888],[0.151755379388448,0.0453001132502831,0.190260475651189,0.612684031710079],[0,0,0,1],[0,0,1,0],[1,0,0,0],[0.0622876557191393,0.571913929784824,0,0.365798414496036],[0.590033975084938,0.029445073612684,0.293318233295583,0.087202718006795]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false},{"name":"Int24","children":[{"name":"Int19","children":[{"name":"CG12768_SANGER_5","motif":[[[0.347826086956522,0.0434782608695652,0,0.608695652173913],[0.260869565217391,0.260869565217391,0.173913043478261,0.304347826086957],[0,0.434782608695652,0,0.565217391304348],[0.0869565217391304,0.0434782608695652,0,0.869565217391304],[1,0,0,0],[0.0434782608695652,0.956521739130435,0,0],[0,1,0,0],[1,0,0,0],[1,0,0,0],[0.304347826086957,0.391304347826087,0,0.304347826086957],[0.434782608695652,0.391304347826087,0,0.173913043478261],[0.347826086956522,0.304347826086957,0,0.347826086956522]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":78,"height":15,"xaxis":true,"yaxis":false},{"name":"Int13","children":[{"name":"rn_SOLEXA_5","motif":[[[0.284140969162996,0.361233480176211,0.259911894273128,0.0947136563876652],[0.279661016949153,0.311440677966102,0.190677966101695,0.218220338983051],[0.317796610169492,0.271186440677966,0.220338983050847,0.190677966101695],[0.247881355932203,0.343220338983051,0.194915254237288,0.213983050847458],[0.394067796610169,0.146186440677966,0.332627118644068,0.127118644067797],[0.11228813559322,0.491525423728814,0.171610169491525,0.224576271186441],[0.980932203389831,0.00423728813559322,0.00847457627118644,0.00635593220338983],[0.955508474576271,0.0105932203389831,0,0.0338983050847458],[1,0,0,0],[1,0,0,0],[0.99364406779661,0,0,0.00635593220338983],[0.953389830508475,0.0466101694915254,0,0],[0.489406779661017,0.283898305084746,0.0826271186440678,0.144067796610169],[0.36228813559322,0.302966101694915,0.192796610169492,0.141949152542373],[0.247881355932203,0.343220338983051,0.245762711864407,0.163135593220339],[0.315677966101695,0.277542372881356,0.224576271186441,0.182203389830508],[0.292372881355932,0.319915254237288,0.201271186440678,0.186440677966102],[0.283898305084746,0.315677966101695,0.24364406779661,0.156779661016949],[0.343220338983051,0.330508474576271,0.156779661016949,0.169491525423729],[0.36864406779661,0.273305084745763,0.205508474576271,0.152542372881356],[0.408898305084746,0.254237288135593,0.222457627118644,0.114406779661017],[0.355932203389831,0.294491525423729,0.211864406779661,0.13771186440678],[0.332627118644068,0.201271186440678,0.245762711864407,0.220338983050847],[0.255874673629243,0.373368146214099,0.174934725848564,0.195822454308094],[0.207843137254902,0.341176470588235,0.266666666666667,0.184313725490196]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":156,"height":15,"xaxis":true,"yaxis":false},{"name":"Int8","children":[{"name":"Cf2_PA_SANGER_2_5","motif":[[[0,0.125,0,0.875],[0.875,0,0,0.125],[0.25,0,0.25,0.5],[0.125,0.5,0.375,0],[0,0.375,0,0.625],[0,0,1,0],[0.875,0.125,0,0],[1,0,0,0],[1,0,0,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":60,"height":15,"xaxis":true,"yaxis":false},{"name":"fkh_NAR","motif":[[[0.111111111111111,0,0,0.888888888888889],[0.185185185185185,0,0.814814814814815,0],[0,0,0,1],[0,0,0,1],[0,0,0.037037037037037,0.962962962962963],[0.481481481481481,0,0.518518518518518,0],[0.148148148148148,0.481481481481481,0.0740740740740741,0.296296296296296],[0.222222222222222,0.259259259259259,0.111111111111111,0.407407407407407],[0,0.407407407407407,0.0740740740740741,0.518518518518518],[0.851851851851852,0,0.037037037037037,0.111111111111111],[0.555555555555556,0.148148148148148,0.148148148148148,0.148148148148148]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":72,"height":15,"xaxis":true,"yaxis":false}]}]}]},{"name":"Int22","children":[{"name":"Vnd_SOLEXA","motif":[[[0.100171232876712,0.344178082191781,0.211472602739726,0.344178082191781],[0.148116438356164,0.0547945205479452,0.0102739726027397,0.786815068493151],[0.0214041095890411,0.476883561643836,0.179794520547945,0.321917808219178],[0.820205479452055,0.0145547945205479,0.163527397260274,0.00171232876712329],[0.956335616438356,0.035958904109589,0.00428082191780822,0.00342465753424658],[0.00256849315068493,0.00599315068493151,0.974315068493151,0.0171232876712329],[0.183219178082192,0.0205479452054795,0.0667808219178082,0.729452054794521],[0.401541095890411,0.00171232876712329,0.584760273972603,0.011986301369863]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false},{"name":"Int7","children":[{"name":"fru_SANGER_10","motif":[[[0.255813953488372,0.465116279069767,0.186046511627907,0.0930232558139535],[0.25,0.431818181818182,0.181818181818182,0.136363636363636],[0.282608695652174,0.434782608695652,0.130434782608696,0.152173913043478],[0.152173913043478,0.5,0.108695652173913,0.239130434782609],[0.173913043478261,0.369565217391304,0.282608695652174,0.173913043478261],[0.565217391304348,0.130434782608696,0.260869565217391,0.0434782608695652],[0.5,0.456521739130435,0.0217391304347826,0.0217391304347826],[0.869565217391304,0,0.130434782608696,0],[0,0.0217391304347826,0.869565217391304,0.108695652173913],[0,0,0,1],[0.978260869565217,0,0.0217391304347826,0],[1,0,0,0],[0.0869565217391304,0.369565217391304,0,0.543478260869565],[0.755555555555556,0.0222222222222222,0.133333333333333,0.0888888888888889]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":90,"height":15,"xaxis":true,"yaxis":false},{"name":"fru_SOLEXA_5","motif":[[[0.246105919003115,0.383177570093458,0.199376947040498,0.171339563862928],[0.26027397260274,0.358904109589041,0.243835616438356,0.136986301369863],[0.243835616438356,0.345205479452055,0.221917808219178,0.189041095890411],[0.257534246575342,0.350684931506849,0.227397260273973,0.164383561643836],[0.315068493150685,0.33972602739726,0.197260273972603,0.147945205479452],[0.30958904109589,0.295890410958904,0.241095890410959,0.153424657534247],[0.26027397260274,0.364383561643836,0.224657534246575,0.150684931506849],[0.221917808219178,0.350684931506849,0.208219178082192,0.219178082191781],[0.26027397260274,0.358904109589041,0.194520547945205,0.186301369863014],[0.161643835616438,0.452054794520548,0.219178082191781,0.167123287671233],[0.43013698630137,0.194520547945205,0.293150684931507,0.0821917808219178],[0.394520547945205,0.556164383561644,0,0.0493150684931507],[1,0,0,0],[0.00547945205479452,0,0.991780821917808,0.00273972602739726],[0,0.00273972602739726,0.00273972602739726,0.994520547945206],[0.934246575342466,0.00821917808219178,0,0.0575342465753425],[0.989041095890411,0.00821917808219178,0.00273972602739726,0],[0.142465753424658,0.512328767123288,0.0547945205479452,0.29041095890411],[0.397260273972603,0.16986301369863,0.238356164383562,0.194520547945205],[0.391780821917808,0.282191780821918,0.186301369863014,0.13972602739726],[0.331506849315069,0.315068493150685,0.227397260273973,0.126027397260274],[0.378082191780822,0.273972602739726,0.243835616438356,0.104109589041096],[0.345205479452055,0.282191780821918,0.2,0.172602739726027],[0.28,0.337142857142857,0.191428571428571,0.191428571428571]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":150,"height":15,"xaxis":true,"yaxis":false}]}]}]}]}]}]},"nodeRadius":2.5,"maxH":15,"maxW":156,"layout":"tree"},"evals":[],"jsHooks":[]}</script><p>Plot the motifs in radialPhylog layout.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/browseMotifs.html">browseMotifs</a></span><span class="op">(</span>pfms <span class="op">=</span> <span class="va">pfms</span>, phylog <span class="op">=</span> <span class="va">phylog</span>, layout<span class="op">=</span><span class="st">"radialPhylog"</span>, yaxis <span class="op">=</span> <span class="cn">FALSE</span>, xaxis <span class="op">=</span> <span class="cn">FALSE</span>, baseWidth<span class="op">=</span><span class="fl">6</span>, baseHeight <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-e900ee7902adc6102f5f" style="width:768px;height:768px;" class="browseMotifs html-widget"></div>
<script type="application/json" data-for="htmlwidget-e900ee7902adc6102f5f">{"x":{"elements":{"name":"Root","children":[{"name":"Int27","children":[{"name":"Int17","children":[{"name":"CG31782_F9_11_SANGER_5","motif":[[[0.714285714285714,0,0.142857142857143,0.142857142857143],[0,0.285714285714286,0.571428571428571,0.142857142857143],[0,0.285714285714286,0.571428571428571,0.142857142857143],[0.142857142857143,0,0,0.857142857142857],[0,1,0,0],[0.714285714285714,0,0,0.285714285714286],[0,1,0,0],[0,1,0,0],[1,0,0,0],[0.285714285714286,0.714285714285714,0,0],[0,0.714285714285714,0,0.285714285714286],[0.857142857142857,0,0,0.142857142857143],[0.857142857142857,0,0.142857142857143,0],[0.833333333333333,0,0,0.166666666666667]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":90,"height":15,"xaxis":false,"yaxis":false},{"name":"CG4360_F1_3_SANGER_2_5","motif":[[[0.625,0.375,0,0],[0,1,0,0],[1,0,0,0],[0.875,0,0.125,0],[0,1,0,0],[1,0,0,0],[1,0,0,0],[0.125,0.875,0,0],[0.875,0,0,0.125],[0.875,0,0,0.125],[0.25,0.375,0.375,0],[0.375,0.625,0,0],[0,0.625,0.375,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":84,"height":15,"xaxis":false,"yaxis":false}]},{"name":"Int25","children":[{"name":"Int16","children":[{"name":"Int9","children":[{"name":"Bteb2_SOLEXA_2_5","motif":[[[0.248322147651007,0.140939597315436,0.305369127516779,0.305369127516779],[0.316455696202532,0.208860759493671,0.155063291139241,0.319620253164557],[0.473846153846154,0.0430769230769231,0.335384615384615,0.147692307692308],[0.243076923076923,0.00615384615384615,0.729230769230769,0.0215384615384615],[0.00923076923076923,0,0.766153846153846,0.224615384615385],[0.0153846153846154,0,0.956923076923077,0.0276923076923077],[0.00307692307692308,0,0.938461538461538,0.0584615384615385],[0.00923076923076923,0,0.978461538461538,0.0123076923076923],[0.0246153846153846,0.92,0,0.0553846153846154],[0.00615384615384615,0,0.975384615384615,0.0184615384615385],[0,0,0.338461538461538,0.661538461538462],[0.443076923076923,0.0830769230769231,0.273846153846154,0.2],[0.255384615384615,0.172307692307692,0.175384615384615,0.396923076923077],[0.254658385093168,0.369565217391304,0.164596273291925,0.211180124223602]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":90,"height":15,"xaxis":false,"yaxis":false},{"name":"sr_SANGER_5","motif":[[[0.210526315789474,0.0526315789473684,0.473684210526316,0.263157894736842],[0.105263157894737,0.0526315789473684,0.263157894736842,0.578947368421053],[0.315789473684211,0.0526315789473684,0.526315789473684,0.105263157894737],[0,0.421052631578947,0.263157894736842,0.315789473684211],[0,0,1,0],[0.0526315789473684,0,0.368421052631579,0.578947368421053],[0,0,1,0],[0,0.0526315789473684,0.947368421052632,0],[0,0,1,0],[0.105263157894737,0.736842105263158,0,0.157894736842105],[0.0526315789473684,0,0.842105263157895,0.105263157894737],[0,0.0526315789473684,0.473684210526316,0.473684210526316],[0.0526315789473684,0.210526315789474,0.473684210526316,0.263157894736842],[0.277777777777778,0,0.444444444444444,0.277777777777778]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":90,"height":15,"xaxis":false,"yaxis":false}]},{"name":"Int14","children":[{"name":"Ci_SANGER_5","motif":[[[0.545454545454545,0,0.363636363636364,0.0909090909090909],[0,0,1,0],[0.727272727272727,0.272727272727273,0,0],[0.181818181818182,0.818181818181818,0,0],[0.0909090909090909,0.909090909090909,0,0],[0.727272727272727,0.181818181818182,0,0.0909090909090909],[0,0.909090909090909,0,0.0909090909090909],[0.272727272727273,0.727272727272727,0,0],[0,1,0,0],[0.909090909090909,0,0.0909090909090909,0],[0,0.818181818181818,0.181818181818182,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":72,"height":15,"xaxis":false,"yaxis":false},{"name":"Opa_SANGER_5","motif":[[[0.583333333333333,0.25,0.0833333333333333,0.0833333333333333],[0.166666666666667,0,0.416666666666667,0.416666666666667],[0.333333333333333,0.416666666666667,0.166666666666667,0.0833333333333333],[0.333333333333333,0.583333333333333,0.0833333333333333,0],[0.25,0.75,0,0],[0.0833333333333333,0.75,0.166666666666667,0],[0,1,0,0],[0,0.916666666666667,0.0833333333333333,0],[0,1,0,0],[0.666666666666667,0.25,0.0833333333333333,0],[0,0.916666666666667,0.0833333333333333,0],[0,0.666666666666667,0,0.333333333333333],[0.25,0,0.75,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":84,"height":15,"xaxis":false,"yaxis":false}]}]},{"name":"Int23","children":[{"name":"Int12","children":[{"name":"usp_SANGER_5","motif":[[[0.523809523809524,0.285714285714286,0,0.19047619047619],[0.428571428571429,0,0.571428571428571,0],[0.714285714285714,0,0.285714285714286,0],[0,0,1,0],[0,0,1,0],[0,0,0,1],[0,1,0,0],[1,0,0,0],[0.428571428571429,0.333333333333333,0.0476190476190476,0.19047619047619]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":60,"height":15,"xaxis":false,"yaxis":false},{"name":"Int4","children":[{"name":"tgo_ss_SANGER_5","motif":[[[0,0.1,0,0.9],[0,0,1,0],[0,0.9,0,0.1],[0,0.1,0.9,0],[0,0,0,1],[0,0,1,0],[1,0,0,0],[0,0.8,0,0.2]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false},{"name":"disco_SANGER_5","motif":[[[0.526315789473684,0.0526315789473684,0.105263157894737,0.315789473684211],[0.6,0,0.2,0.2],[0.25,0,0.4,0.35],[0,0,0,1],[0.0526315789473684,0,0.947368421052632,0],[0,0,0,1],[0,1,0,0],[0.9,0,0.05,0.05],[0,1,0,0],[0.25,0.7,0.05,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":66,"height":15,"xaxis":false,"yaxis":false}]}]},{"name":"Int21","children":[{"name":"CG4404_SANGER_5","motif":[[[0.266666666666667,0,0.666666666666667,0.0666666666666667],[0,0.933333333333333,0.0666666666666667,0],[1,0,0,0],[0,0,1,0],[0,0.333333333333333,0,0.666666666666667],[1,0,0,0],[0.666666666666667,0,0,0.333333333333333],[0.4,0.133333333333333,0,0.466666666666667],[0.0666666666666667,0,0.133333333333333,0.8],[0.666666666666667,0.0666666666666667,0.133333333333333,0.133333333333333],[0.333333333333333,0.4,0.266666666666667,0],[0.6,0.266666666666667,0.133333333333333,0],[0,0.333333333333333,0.6,0.0666666666666667],[0.266666666666667,0.533333333333333,0.133333333333333,0.0666666666666667]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":90,"height":15,"xaxis":false,"yaxis":false},{"name":"Int11","children":[{"name":"HLH4C_da_SANGER_5_3","motif":[[[0,1,0,0],[1,0,0,0],[0,1,0,0],[0,1,0,0],[0,0,0,1],[0,0,1,0],[0.333333333333333,0.666666666666667,0,0],[0.25,0.0833333333333333,0.333333333333333,0.333333333333333],[0.0833333333333333,0.833333333333333,0,0.0833333333333333],[0.0909090909090909,0.727272727272727,0.0909090909090909,0.0909090909090909]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":66,"height":15,"xaxis":false,"yaxis":false},{"name":"scrt_SOLEXA_2_5_2","motif":[[[0.467432950191571,0.226053639846743,0.256704980842912,0.0498084291187739],[0.204697986577181,0.61744966442953,0.110738255033557,0.0671140939597315],[0.0716510903426791,0.819314641744548,0.0342679127725857,0.0747663551401869],[0.987538940809969,0,0.00934579439252336,0.00311526479750779],[0,0.993769470404984,0,0.00623052959501558],[0,0.956386292834891,0,0.043613707165109],[0.00311526479750779,0.00623052959501558,0.0124610591900312,0.978193146417445],[0,0,0.987538940809969,0.0124610591900312],[0.00934579439252336,0,0,0.990654205607477],[0.0872274143302181,0.00311526479750779,0.105919003115265,0.803738317757009],[0.11214953271028,0.00934579439252336,0.856697819314642,0.0218068535825545],[0.383177570093458,0.442367601246106,0.0685358255451713,0.105919003115265],[0.383177570093458,0.171339563862928,0.227414330218069,0.218068535825545]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":84,"height":15,"xaxis":false,"yaxis":false}]}]}]}]}]},{"name":"Int28","children":[{"name":"Int20","children":[{"name":"en_FlyReg","motif":[[[0.377358490566038,0.0566037735849057,0.339622641509434,0.226415094339623],[0.0943396226415094,0.283018867924528,0.226415094339623,0.39622641509434],[0.132075471698113,0.132075471698113,0,0.735849056603774],[0.716981132075472,0,0.0754716981132075,0.207547169811321],[0.981132075471698,0,0,0.0188679245283019],[0,0.0377358490566038,0.0377358490566038,0.924528301886792],[0,0.113207547169811,0.264150943396226,0.622641509433962],[0.509433962264151,0,0.490566037735849,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false},{"name":"Int18","children":[{"name":"Int10","children":[{"name":"Zen_Cell","motif":[[[0.1875,0.3125,0.25,0.25],[0.125,0.5,0.25,0.125],[0.125,0.5625,0,0.3125],[0,0,0,1],[1,0,0,0],[1,0,0,0],[0,0,0,1],[0,0,0.6875,0.3125],[1,0,0,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":60,"height":15,"xaxis":false,"yaxis":false},{"name":"CG11085_Cell","motif":[[[0.153846153846154,0.307692307692308,0.153846153846154,0.384615384615385],[0,0.230769230769231,0,0.769230769230769],[0,0,0,1],[1,0,0,0],[1,0,0,0],[0.0769230769230769,0,0,0.923076923076923],[0.153846153846154,0.0769230769230769,0.153846153846154,0.615384615384615],[0.0769230769230769,0,0.923076923076923,0],[0.153846153846154,0.307692307692308,0.461538461538462,0.0769230769230769]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":60,"height":15,"xaxis":false,"yaxis":false}]},{"name":"Int15","children":[{"name":"Lbe_Cell","motif":[[[0.136363636363636,0.227272727272727,0.409090909090909,0.227272727272727],[0.181818181818182,0.272727272727273,0.0909090909090909,0.454545454545455],[0,0,0,1],[1,0,0,0],[1,0,0,0],[0.0454545454545455,0.454545454545455,0.0909090909090909,0.409090909090909],[0.181818181818182,0.227272727272727,0.136363636363636,0.454545454545455],[0.863636363636364,0,0.136363636363636,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false},{"name":"Int6","children":[{"name":"Zen_SOLEXA","motif":[[[0.218527315914489,0.318289786223278,0.26603325415677,0.197149643705463],[0.0973871733966746,0.380047505938242,0.0902612826603325,0.432304038004751],[0.0380047505938242,0.00475059382422803,0,0.957244655581948],[0.973871733966746,0.0261282660332542,0,0],[0.978622327790974,0.0213776722090261,0,0],[0,0.0213776722090261,0,0.978622327790974],[0.0118764845605701,0.00475059382422803,0.498812351543943,0.484560570071259],[0.893111638954869,0.00712589073634204,0.0997624703087886,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false},{"name":"Int5","children":[{"name":"Lbl_Cell","motif":[[[0.217391304347826,0.217391304347826,0.478260869565217,0.0869565217391304],[0.217391304347826,0.434782608695652,0,0.347826086956522],[0,0,0,1],[1,0,0,0],[1,0,0,0],[0,0.217391304347826,0,0.782608695652174],[0.0434782608695652,0.130434782608696,0.304347826086957,0.521739130434783],[0.739130434782609,0,0.260869565217391,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false},{"name":"Int3","children":[{"name":"tup_SOLEXA_10","motif":[[[0.217445225299711,0.266225713104589,0.262091773460107,0.254237288135593],[0.11547811993517,0.357374392220421,0.114667747163695,0.412479740680713],[0.0522690437601297,0,0,0.94773095623987],[0.989465153970827,0,0.0105348460291734,0],[1,0,0,0],[0,0,0.151134521880065,0.848865478119935],[0.0632090761750405,0.0121555915721232,0.437196110210697,0.487439222042139],[0.301189987689783,0.0471891670086172,0.595404185473943,0.056216659827657],[0.34576067348166,0.269392663860493,0.263379434756464,0.121467227901383]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":60,"height":15,"xaxis":false,"yaxis":false},{"name":"Int2","children":[{"name":"Zen2_SOLEXA","motif":[[[0.119391025641026,0.31650641025641,0.104166666666667,0.459935897435897],[0.0721153846153846,0,0,0.927884615384615],[0.967147435897436,0,0.0224358974358974,0.0104166666666667],[1,0,0,0],[0.00240384615384615,0.0649038461538462,0,0.932692307692308],[0.047275641025641,0.0016025641025641,0.462339743589744,0.488782051282051],[0.740384615384615,0,0.25,0.00961538461538462]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":48,"height":15,"xaxis":false,"yaxis":false},{"name":"Int1","children":[{"name":"PhdP_SOLEXA","motif":[[[0.132894736842105,0.298684210526316,0.0881578947368421,0.480263157894737],[0.0223684210526316,0,0,0.977631578947368],[0.980263157894737,0,0,0.0197368421052632],[1,0,0,0],[0,0,0,1],[0.0486842105263158,0.0263157894736842,0.068421052631579,0.856578947368421]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":42,"height":15,"xaxis":false,"yaxis":false},{"name":"Unc4_SOLEXA","motif":[[[0.188541666666667,0.320833333333333,0.23125,0.259375],[0.136458333333333,0.310416666666667,0.117708333333333,0.435416666666667],[0.0208333333333333,0.00729166666666667,0.00833333333333333,0.963541666666667],[0.982291666666667,0.0114583333333333,0.00208333333333333,0.00416666666666667],[0.992708333333333,0.00729166666666667,0,0],[0,0.0145833333333333,0.0291666666666667,0.95625],[0.0364583333333333,0.0208333333333333,0.0885416666666667,0.854166666666667],[0.477083333333333,0.0145833333333333,0.445833333333333,0.0625]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false}]}]}]}]}]}]}]}]},{"name":"Int26","children":[{"name":"Exd_SOLEXA","motif":[[[0.292185730464326,0.172140430351076,0.234428086070215,0.301245753114383],[0.181200453001132,0.194790486976217,0.161947904869762,0.462061155152888],[0.151755379388448,0.0453001132502831,0.190260475651189,0.612684031710079],[0,0,0,1],[0,0,1,0],[1,0,0,0],[0.0622876557191393,0.571913929784824,0,0.365798414496036],[0.590033975084938,0.029445073612684,0.293318233295583,0.087202718006795]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false},{"name":"Int24","children":[{"name":"Int19","children":[{"name":"CG12768_SANGER_5","motif":[[[0.347826086956522,0.0434782608695652,0,0.608695652173913],[0.260869565217391,0.260869565217391,0.173913043478261,0.304347826086957],[0,0.434782608695652,0,0.565217391304348],[0.0869565217391304,0.0434782608695652,0,0.869565217391304],[1,0,0,0],[0.0434782608695652,0.956521739130435,0,0],[0,1,0,0],[1,0,0,0],[1,0,0,0],[0.304347826086957,0.391304347826087,0,0.304347826086957],[0.434782608695652,0.391304347826087,0,0.173913043478261],[0.347826086956522,0.304347826086957,0,0.347826086956522]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":78,"height":15,"xaxis":false,"yaxis":false},{"name":"Int13","children":[{"name":"rn_SOLEXA_5","motif":[[[0.284140969162996,0.361233480176211,0.259911894273128,0.0947136563876652],[0.279661016949153,0.311440677966102,0.190677966101695,0.218220338983051],[0.317796610169492,0.271186440677966,0.220338983050847,0.190677966101695],[0.247881355932203,0.343220338983051,0.194915254237288,0.213983050847458],[0.394067796610169,0.146186440677966,0.332627118644068,0.127118644067797],[0.11228813559322,0.491525423728814,0.171610169491525,0.224576271186441],[0.980932203389831,0.00423728813559322,0.00847457627118644,0.00635593220338983],[0.955508474576271,0.0105932203389831,0,0.0338983050847458],[1,0,0,0],[1,0,0,0],[0.99364406779661,0,0,0.00635593220338983],[0.953389830508475,0.0466101694915254,0,0],[0.489406779661017,0.283898305084746,0.0826271186440678,0.144067796610169],[0.36228813559322,0.302966101694915,0.192796610169492,0.141949152542373],[0.247881355932203,0.343220338983051,0.245762711864407,0.163135593220339],[0.315677966101695,0.277542372881356,0.224576271186441,0.182203389830508],[0.292372881355932,0.319915254237288,0.201271186440678,0.186440677966102],[0.283898305084746,0.315677966101695,0.24364406779661,0.156779661016949],[0.343220338983051,0.330508474576271,0.156779661016949,0.169491525423729],[0.36864406779661,0.273305084745763,0.205508474576271,0.152542372881356],[0.408898305084746,0.254237288135593,0.222457627118644,0.114406779661017],[0.355932203389831,0.294491525423729,0.211864406779661,0.13771186440678],[0.332627118644068,0.201271186440678,0.245762711864407,0.220338983050847],[0.255874673629243,0.373368146214099,0.174934725848564,0.195822454308094],[0.207843137254902,0.341176470588235,0.266666666666667,0.184313725490196]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":156,"height":15,"xaxis":false,"yaxis":false},{"name":"Int8","children":[{"name":"Cf2_PA_SANGER_2_5","motif":[[[0,0.125,0,0.875],[0.875,0,0,0.125],[0.25,0,0.25,0.5],[0.125,0.5,0.375,0],[0,0.375,0,0.625],[0,0,1,0],[0.875,0.125,0,0],[1,0,0,0],[1,0,0,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":60,"height":15,"xaxis":false,"yaxis":false},{"name":"fkh_NAR","motif":[[[0.111111111111111,0,0,0.888888888888889],[0.185185185185185,0,0.814814814814815,0],[0,0,0,1],[0,0,0,1],[0,0,0.037037037037037,0.962962962962963],[0.481481481481481,0,0.518518518518518,0],[0.148148148148148,0.481481481481481,0.0740740740740741,0.296296296296296],[0.222222222222222,0.259259259259259,0.111111111111111,0.407407407407407],[0,0.407407407407407,0.0740740740740741,0.518518518518518],[0.851851851851852,0,0.037037037037037,0.111111111111111],[0.555555555555556,0.148148148148148,0.148148148148148,0.148148148148148]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":72,"height":15,"xaxis":false,"yaxis":false}]}]}]},{"name":"Int22","children":[{"name":"Vnd_SOLEXA","motif":[[[0.100171232876712,0.344178082191781,0.211472602739726,0.344178082191781],[0.148116438356164,0.0547945205479452,0.0102739726027397,0.786815068493151],[0.0214041095890411,0.476883561643836,0.179794520547945,0.321917808219178],[0.820205479452055,0.0145547945205479,0.163527397260274,0.00171232876712329],[0.956335616438356,0.035958904109589,0.00428082191780822,0.00342465753424658],[0.00256849315068493,0.00599315068493151,0.974315068493151,0.0171232876712329],[0.183219178082192,0.0205479452054795,0.0667808219178082,0.729452054794521],[0.401541095890411,0.00171232876712329,0.584760273972603,0.011986301369863]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false},{"name":"Int7","children":[{"name":"fru_SANGER_10","motif":[[[0.255813953488372,0.465116279069767,0.186046511627907,0.0930232558139535],[0.25,0.431818181818182,0.181818181818182,0.136363636363636],[0.282608695652174,0.434782608695652,0.130434782608696,0.152173913043478],[0.152173913043478,0.5,0.108695652173913,0.239130434782609],[0.173913043478261,0.369565217391304,0.282608695652174,0.173913043478261],[0.565217391304348,0.130434782608696,0.260869565217391,0.0434782608695652],[0.5,0.456521739130435,0.0217391304347826,0.0217391304347826],[0.869565217391304,0,0.130434782608696,0],[0,0.0217391304347826,0.869565217391304,0.108695652173913],[0,0,0,1],[0.978260869565217,0,0.0217391304347826,0],[1,0,0,0],[0.0869565217391304,0.369565217391304,0,0.543478260869565],[0.755555555555556,0.0222222222222222,0.133333333333333,0.0888888888888889]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":90,"height":15,"xaxis":false,"yaxis":false},{"name":"fru_SOLEXA_5","motif":[[[0.246105919003115,0.383177570093458,0.199376947040498,0.171339563862928],[0.26027397260274,0.358904109589041,0.243835616438356,0.136986301369863],[0.243835616438356,0.345205479452055,0.221917808219178,0.189041095890411],[0.257534246575342,0.350684931506849,0.227397260273973,0.164383561643836],[0.315068493150685,0.33972602739726,0.197260273972603,0.147945205479452],[0.30958904109589,0.295890410958904,0.241095890410959,0.153424657534247],[0.26027397260274,0.364383561643836,0.224657534246575,0.150684931506849],[0.221917808219178,0.350684931506849,0.208219178082192,0.219178082191781],[0.26027397260274,0.358904109589041,0.194520547945205,0.186301369863014],[0.161643835616438,0.452054794520548,0.219178082191781,0.167123287671233],[0.43013698630137,0.194520547945205,0.293150684931507,0.0821917808219178],[0.394520547945205,0.556164383561644,0,0.0493150684931507],[1,0,0,0],[0.00547945205479452,0,0.991780821917808,0.00273972602739726],[0,0.00273972602739726,0.00273972602739726,0.994520547945206],[0.934246575342466,0.00821917808219178,0,0.0575342465753425],[0.989041095890411,0.00821917808219178,0.00273972602739726,0],[0.142465753424658,0.512328767123288,0.0547945205479452,0.29041095890411],[0.397260273972603,0.16986301369863,0.238356164383562,0.194520547945205],[0.391780821917808,0.282191780821918,0.186301369863014,0.13972602739726],[0.331506849315069,0.315068493150685,0.227397260273973,0.126027397260274],[0.378082191780822,0.273972602739726,0.243835616438356,0.104109589041096],[0.345205479452055,0.282191780821918,0.2,0.172602739726027],[0.28,0.337142857142857,0.191428571428571,0.191428571428571]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":150,"height":15,"xaxis":false,"yaxis":false}]}]}]}]}]}]},"nodeRadius":2.5,"maxH":15,"maxW":156,"layout":"radialPhylog"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="docker-container-for-motifstack" class="section level1">
<h1 class="hasAnchor">
<a href="#docker-container-for-motifstack" class="anchor"></a>docker container for motifStack</h1>
<p><a href="https://docs.docker.com/">Docker</a> container allows software to be packaged into containers which can be run in any platform using a virtual machine called boot2docker. To ease the installation of motifStack and its depencies, we have created a docker image containing all the components needed to run motifStack. Users can download the <a href="https://hub.docker.com/r/jianhong/motifstack/">motifStack docker</a> image using the following code snippet.</p>
<pre>
cd ~ ## in windows, please try cd c:\\ Users\\ username
docker pull jianhong/motifstack:latest
mkdir tmp4motifstack ## this will be the share folder for your host and container.
docker run -ti --rm -v ${PWD}/tmp4motifstack:/volume/data jianhong/motifstack:latest bash
  In motifstack:latest docker
    1  cd /volume/data
    2  git clone https://github.com/jianhong/motifStack.documentation.git
    3  cd motifStack.documentation/
    4  cp /usr/bin/matalign app/matalign-v4a
    5  cp /usr/bin/phylip/neighbor app/neighbor.app/Contents/MacOS/neighbor
    6  R cmd -e "rmarkdown::render('suppFigure2.Rmd')"
    7  R cmd -e "rmarkdown::render('suppFigure6.Rmd')"
</pre>
<p>You will see the test.pdf file in the folder of tmp4motifstack.</p>
</div>
<div id="plot-motifs-with-ggplot2" class="section level1">
<h1 class="hasAnchor">
<a href="#plot-motifs-with-ggplot2" class="anchor"></a>plot motifs with ggplot2</h1>
<p>motifs could be plotted by <code>geom_motif</code> function.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html">find.package</a></span><span class="op">(</span><span class="st">"motifStack"</span><span class="op">)</span>, 
                            <span class="st">"extdata"</span>, <span class="st">"bin_SOLEXA.pcm"</span><span class="op">)</span><span class="op">)</span>
<span class="va">pcm</span> <span class="op">&lt;-</span> <span class="va">pcm</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">pcm</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">pcm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"C"</span>,<span class="st">"G"</span>,<span class="st">"T"</span><span class="op">)</span>
<span class="va">markerRect</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"marker"</span>, type<span class="op">=</span><span class="st">"rect"</span>, start<span class="op">=</span><span class="fl">6</span>, stop<span class="op">=</span><span class="fl">7</span>, gp<span class="op">=</span><span class="fu">gpar</span><span class="op">(</span>lty<span class="op">=</span><span class="fl">2</span>, fill<span class="op">=</span><span class="cn">NA</span>, col<span class="op">=</span><span class="st">"orange"</span><span class="op">)</span><span class="op">)</span>
<span class="va">markerLine</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"marker"</span>, type<span class="op">=</span><span class="st">"line"</span>, start<span class="op">=</span><span class="fl">3</span>, stop<span class="op">=</span><span class="fl">5</span>, gp<span class="op">=</span><span class="fu">gpar</span><span class="op">(</span>lwd<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">)</span>
<span class="va">markerText</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"marker"</span>, type<span class="op">=</span><span class="st">"text"</span>, start<span class="op">=</span><span class="fl">1</span>, label<span class="op">=</span><span class="st">"*"</span>, gp<span class="op">=</span><span class="fu">gpar</span><span class="op">(</span>cex<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">)</span>
<span class="va">motif</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"pcm"</span>, mat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">pcm</span><span class="op">)</span>, name<span class="op">=</span><span class="st">"bin_SOLEXA"</span>, 
             markers<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">markerRect</span>, <span class="va">markerLine</span>, <span class="va">markerText</span><span class="op">)</span><span class="op">)</span>
<span class="va">pfm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcm-class.html">pcm2pfm</a></span><span class="op">(</span><span class="va">motif</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>xmin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="fl">.25</span><span class="op">)</span>, ymin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="fl">.75</span><span class="op">)</span>, xmax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.75</span>, <span class="fl">.75</span><span class="op">)</span>, ymax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">1</span><span class="op">)</span>, 
                 fontfamily<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Helvetica"</span>, <span class="st">"mono,Courier"</span><span class="op">)</span>, fontface<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">motif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">pfm</span>, <span class="va">pfm</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin<span class="op">=</span><span class="va">xmin</span>, ymin<span class="op">=</span><span class="va">ymin</span>, xmax<span class="op">=</span><span class="va">xmax</span>, ymax<span class="op">=</span><span class="va">ymax</span>, motif<span class="op">=</span><span class="va">motif</span>, 
               fontfamily<span class="op">=</span><span class="va">fontfamily</span>, fontface<span class="op">=</span><span class="va">fontface</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="../reference/geom_motif.html">geom_motif</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="motifStack_HTML_files/figure-html/geommotif-1.png" width="768"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">.5</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="fl">.75</span><span class="op">)</span>, width<span class="op">=</span><span class="fl">.5</span>, height<span class="op">=</span><span class="fl">.25</span>, 
                 fontfamily<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Helvetica"</span>, <span class="st">"mono,Courier"</span><span class="op">)</span>, fontface<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">motif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">pfm</span>, <span class="va">pfm</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, width<span class="op">=</span><span class="va">width</span>, height<span class="op">=</span><span class="va">height</span>, motif<span class="op">=</span><span class="va">motif</span>, 
               fontfamily<span class="op">=</span><span class="va">fontfamily</span>, fontface<span class="op">=</span><span class="va">fontface</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="../reference/geom_motif.html">geom_motif</a></span><span class="op">(</span>use.xy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="motifStack_HTML_files/figure-html/geommotif-2.png" width="768"></p>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h1>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R Under development (unstable) (2021-03-18 r80099)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.2 LTS
## 
## Matrix products: default
## BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.8.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=C             
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
##  [1] stats4    parallel  grid      stats     graphics  grDevices utils    
##  [8] datasets  methods   base     
## 
## other attached packages:
##  [1] RColorBrewer_1.1-2   ggplot2_3.3.3        ade4_1.7-16         
##  [4] MotifDb_1.33.0       Biostrings_2.59.2    XVector_0.31.1      
##  [7] GenomicRanges_1.43.3 GenomeInfoDb_1.27.8  IRanges_2.25.6      
## [10] S4Vectors_0.29.9     BiocGenerics_0.37.1  motifStack_1.35.1   
## [13] knitr_1.31          
## 
## loaded via a namespace (and not attached):
##  [1] MatrixGenerics_1.3.1        Biobase_2.51.0             
##  [3] jsonlite_1.7.2              highr_0.8                  
##  [5] BiocManager_1.30.12         GenomeInfoDbData_1.2.4     
##  [7] Rsamtools_2.7.1             yaml_2.2.1                 
##  [9] progress_1.2.2              pillar_1.5.1               
## [11] lattice_0.20-41             glue_1.4.2                 
## [13] digest_0.6.27               colorspace_2.0-0           
## [15] htmltools_0.5.1.1           Matrix_1.3-2               
## [17] XML_3.99-0.6                pkgconfig_2.0.3            
## [19] grImport2_0.2-0             zlibbioc_1.37.0            
## [21] scales_1.1.1                jpeg_0.1-8.1               
## [23] BiocParallel_1.25.5         tibble_3.1.0               
## [25] ellipsis_0.3.1              cachem_1.0.4               
## [27] withr_2.4.1                 SummarizedExperiment_1.21.1
## [29] splitstackshape_1.4.8       magrittr_2.0.1             
## [31] crayon_1.4.1                memoise_2.0.0              
## [33] evaluate_0.14               fs_1.5.0                   
## [35] fansi_0.4.2                 MASS_7.3-53.1              
## [37] textshaping_0.3.3           tools_4.1.0                
## [39] data.table_1.14.0           prettyunits_1.1.1          
## [41] hms_1.0.0                   BiocStyle_2.19.2           
## [43] BiocIO_1.1.2                lifecycle_1.0.0            
## [45] matrixStats_0.58.0          stringr_1.4.0              
## [47] munsell_0.5.0               DelayedArray_0.17.10       
## [49] compiler_4.1.0              pkgdown_1.6.1              
## [51] systemfonts_1.0.1           rlang_0.4.10               
## [53] debugme_1.1.0               RCurl_1.98-1.3             
## [55] rjson_0.2.20                htmlwidgets_1.5.3          
## [57] labeling_0.4.2              bitops_1.0-6               
## [59] base64enc_0.1-3             rmarkdown_2.7              
## [61] restfulr_0.0.13             gtable_0.3.0               
## [63] R6_2.5.0                    GenomicAlignments_1.27.2   
## [65] rtracklayer_1.51.5          fastmap_1.1.0              
## [67] utf8_1.2.1                  rprojroot_2.0.2            
## [69] ragg_1.1.2                  desc_1.3.0                 
## [71] stringi_1.5.3               png_0.1-7                  
## [73] vctrs_0.3.7                 xfun_0.22</code></pre>
</div>
<div id="reference" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#reference" class="anchor"></a>Reference</h1>
<div id="refs" class="references csl-bib-body" line-spacing="2">
<div id="ref-Oliver2006" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">Bembom, O. seqLogo: Sequence logos for DNA sequence alignments. <em>R package version 1.5.4</em> (2006).</div>
</div>
<div id="ref-foat2006statistical" class="csl-entry">
<div class="csl-left-margin">2. </div>
<div class="csl-right-inline">Foat, B. C., Morozov, A. V. &amp; Bussemaker, H. J. Statistical mechanical modeling of genome-wide transcription factor occupancy data by MatrixREDUCE. <em>Bioinformatics</em> <strong>22,</strong> e141–e149 (2006).</div>
</div>
<div id="ref-Eloi2010" class="csl-entry">
<div class="csl-left-margin">3. </div>
<div class="csl-right-inline">Mercier, E. &amp; Gottardo, R. MotIV: Motif identification and validation. <em>R package version 1.10.0</em> (2010).</div>
</div>
<div id="ref-Mahony2007" class="csl-entry">
<div class="csl-left-margin">4. </div>
<div class="csl-right-inline">S, M. &amp; PV, B. STAMP: A web tool for exploring DNA-binding motif similarities. <em>Nucleic Acids Res.</em> <strong>35(Web Server issue),</strong> W253–W258 (2007).</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jianhong Ou, Lihua Julie Zhu Developer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
