<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>motifStack Vignette • motifStack</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="motifStack Vignette">
<meta property="og:description" content="motifStack">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">motifStack</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.43.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/motifStack_HTML.html">motifStack Vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="motifStack_HTML_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="motifStack_HTML_files/d3-4.4.0/d3.v4.min.js"></script><link href="motifStack_HTML_files/plotWebLogo-0.0.1/d3-plotWebLogo.css" rel="stylesheet">
<script src="motifStack_HTML_files/plotWebLogo-0.0.1/d3-plotWebLogo.js"></script><script src="motifStack_HTML_files/saveSvgAsPng-0.0.1/saveSvgAsPng.js"></script><link href="motifStack_HTML_files/d3-tip-0.8.0/d3-tip.css" rel="stylesheet">
<script src="motifStack_HTML_files/d3-tip-0.8.0/d3-tip.js"></script><script src="motifStack_HTML_files/browseMotifs-binding-1.43.0/browseMotifs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>motifStack Vignette</h1>
                        <h4 data-toc-skip class="author">Jianhong Ou,
Michael Brodsky, Lihua Julie Zhu</h4>
            
            <h4 data-toc-skip class="date">11 November 2022</h4>
      
      
      <div class="hidden name"><code>motifStack_HTML.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>The motifStack package is designed for graphic representation
      of multiple motifs with different similarity scores. It works with
      both DNA/RNA sequence motif, affinity logo and amino acid sequence
      motif. In addition, it provides the flexibility for users to
      customize the graphic parameters such as the font type and symbol
      colors.</p>
    </div>
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>A sequence logo, based on information theory, has been widely used as
a graphical representation of sequence conservation (aka motif) in
multiple amino acid or nucleic acid sequences. Sequence motif represents
conserved characteristics such as DNA binding sites, where transcription
factors bind, and catalytic sites in enzymes. Although many tools, such
as seqlogo<span class="citation"><sup>1</sup></span>, have been
developed to create sequence motif and to represent it as individual
sequence logo, software tools for depicting the relationship among
multiple sequence motifs are still lacking. We developed a flexible and
powerful open-source R/Bioconductor package,
<strong>motifStack</strong>, for visualization of the alignment of
multiple sequence motifs.</p>
</div>
<div class="section level2">
<h2 id="import-matrix">Import matrix<a class="anchor" aria-label="anchor" href="#import-matrix"></a>
</h2>
<p>The <code>importMatrix</code> function is used to import motifs from
files or convert <code>XMatrix</code>/<code>XMatrixList</code> object
into <strong>motifStack</strong> compatable format.</p>
<div class="section level3">
<h3 id="convert-motifs-from-xmatrixlist">convert motifs from <code>XMatrixList</code><a class="anchor" aria-label="anchor" href="#convert-motifs-from-xmatrixlist"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">motifStack</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://jaspar.genereg.net/" class="external-link">JASPAR2020</a></span><span class="op">)</span></span>
<span><span class="va">motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/importMatrix.html">importMatrix</a></span><span class="op">(</span><span class="fu">getMatrixSet</span><span class="op">(</span><span class="va">JASPAR2020</span>, </span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>species<span class="op">=</span><span class="st">"Mus musculus"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motifs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/importMatrix-1.png" alt="import data from PFMatrixList" width="576"><p class="caption">
import data from PFMatrixList
</p>
</div>
</div>
<div class="section level3">
<h3 id="import-motifs-from-files">import motifs from files<a class="anchor" aria-label="anchor" href="#import-motifs-from-files"></a>
</h3>
<p>The supported formats are “meme”, “transfac”, “jaspar”, “scpd”,
“cisbp”, and “psam”.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RUNX1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/importMatrix.html">importMatrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"MA0002.1.jaspar"</span>,</span>
<span>                                  package <span class="op">=</span> <span class="st">"motifStack"</span>,</span>
<span>                                  mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">RUNX1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/importFromFiles-1.png" alt="import data from file" width="576"><p class="caption">
import data from file
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="examples-of-using-motifstack">Examples of using motifStack<a class="anchor" aria-label="anchor" href="#examples-of-using-motifstack"></a>
</h2>
<div class="section level3">
<h3 id="plot-a-dna-sequence-logo-with-different-fonts-and-colors">plot a DNA sequence logo with different fonts and colors<a class="anchor" aria-label="anchor" href="#plot-a-dna-sequence-logo-with-different-fonts-and-colors"></a>
</h3>
<p>Users can select different fonts and colors to draw the sequence
logo.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">motifStack</span><span class="op">)</span></span>
<span><span class="va">pcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">find.package</a></span><span class="op">(</span><span class="st">"motifStack"</span><span class="op">)</span>, </span>
<span>                            <span class="st">"extdata"</span>, <span class="st">"bin_SOLEXA.pcm"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pcm</span> <span class="op">&lt;-</span> <span class="va">pcm</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">pcm</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">pcm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"C"</span>,<span class="st">"G"</span>,<span class="st">"T"</span><span class="op">)</span></span>
<span><span class="va">motif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"pcm"</span>, mat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">pcm</span><span class="op">)</span>, name<span class="op">=</span><span class="st">"bin_SOLEXA"</span><span class="op">)</span></span>
<span><span class="co">##pfm object</span></span>
<span><span class="co">#motif &lt;- pcm2pfm(pcm)</span></span>
<span><span class="co">#motif &lt;- new("pfm", mat=motif, name="bin_SOLEXA")</span></span>
<span><span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motif</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/DNAseqLogo-1.png" alt="Plot a DNA sequence logo with different fonts and colors" width="768"><p class="caption">
Plot a DNA sequence logo with different fonts and colors
</p>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#plot the logo with same height</span></span>
<span><span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motif</span>, ic.scale<span class="op">=</span><span class="cn">FALSE</span>, ylab<span class="op">=</span><span class="st">"probability"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/DNAseqLogo-2.png" alt="Plot a DNA sequence logo with different fonts and colors" width="768"><p class="caption">
Plot a DNA sequence logo with different fonts and colors
</p>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#try a different font and a different color group</span></span>
<span><span class="va">motif</span><span class="op">@</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/colorset.html">colorset</a></span><span class="op">(</span>colorScheme<span class="op">=</span><span class="st">'basepairing'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motif</span>,font<span class="op">=</span><span class="st">"serif"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/DNAseqLogo-3.png" alt="Plot a DNA sequence logo with different fonts and colors" width="768"><p class="caption">
Plot a DNA sequence logo with different fonts and colors
</p>
</div>
</div>
<div class="section level3">
<h3 id="plot-sequence-logo-with-markers">plot sequence logo with markers<a class="anchor" aria-label="anchor" href="#plot-sequence-logo-with-markers"></a>
</h3>
<p>If you assign markers slot by a list of <code>marker</code> object,
markers can be plotted in the figure. There are three type of markers,
“rect”, “line” and “text”.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">markerRect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"marker"</span>, type<span class="op">=</span><span class="st">"rect"</span>, start<span class="op">=</span><span class="fl">6</span>, stop<span class="op">=</span><span class="fl">7</span>, gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>lty<span class="op">=</span><span class="fl">2</span>, fill<span class="op">=</span><span class="cn">NA</span>, col<span class="op">=</span><span class="st">"orange"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">markerLine</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"marker"</span>, type<span class="op">=</span><span class="st">"line"</span>, start<span class="op">=</span><span class="fl">2</span>, stop<span class="op">=</span><span class="fl">7</span>, gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>lwd<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">markerText</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"marker"</span>, type<span class="op">=</span><span class="st">"text"</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, </span>
<span>                  label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"*"</span>, <span class="st">"core"</span><span class="op">)</span>, gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">motif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"pcm"</span>, mat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">pcm</span><span class="op">)</span>, name<span class="op">=</span><span class="st">"bin_SOLEXA"</span>, </span>
<span>             markers<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">markerRect</span>, <span class="va">markerLine</span>, <span class="va">markerText</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motif</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/seqLogoMarkers-1.png" alt="Plot a DNA sequence logo with markers" width="768"><p class="caption">
Plot a DNA sequence logo with markers
</p>
</div>
</div>
<div class="section level3">
<h3 id="change-the-x-axis-labels">change the x-axis labels<a class="anchor" aria-label="anchor" href="#change-the-x-axis-labels"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motif</span>, xaxis<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"pos"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq.int</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span><span class="op">+</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/seqLogoXaxis-1.png" alt="Plot a DNA sequence logo with pre-defined xlabels" width="768"><p class="caption">
Plot a DNA sequence logo with pre-defined xlabels
</p>
</div>
</div>
<div class="section level3">
<h3 id="plot-a-rna-sequence-logo">plot a RNA sequence logo<a class="anchor" aria-label="anchor" href="#plot-a-rna-sequence-logo"></a>
</h3>
<p>To plot a RNA sequence logo, you only need to change the rowname of
the matrix from “T” to “U” as follows.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">&lt;-</span> <span class="va">pcm</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">rna</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"U"</span></span>
<span><span class="va">motif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"pcm"</span>, mat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">rna</span><span class="op">)</span>, name<span class="op">=</span><span class="st">"RNA_motif"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motif</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/RNAseqLogo-1.png" alt="Plot an RNA sequence logo" width="576"><p class="caption">
Plot an RNA sequence logo
</p>
</div>
</div>
<div class="section level3">
<h3 id="plot-an-amino-acid-sequence-logo">plot an amino acid sequence logo<a class="anchor" aria-label="anchor" href="#plot-an-amino-acid-sequence-logo"></a>
</h3>
<p>Given that motifStack allows to use any letters as symbols, it can
also be used to draw amino acid sequence logos.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">motifStack</span><span class="op">)</span></span>
<span><span class="va">protein</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">find.package</a></span><span class="op">(</span><span class="st">"motifStack"</span><span class="op">)</span>,<span class="st">"extdata"</span>,<span class="st">"cap.txt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">protein</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">protein</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">motif</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/pcm-class.html">pcm2pfm</a></span><span class="op">(</span><span class="va">protein</span><span class="op">)</span></span>
<span><span class="va">motif</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"pfm"</span>, mat<span class="op">=</span><span class="va">motif</span>, name<span class="op">=</span><span class="st">"CAP"</span>, </span>
<span>            color<span class="op">=</span><span class="fu"><a href="../reference/colorset.html">colorset</a></span><span class="op">(</span>alphabet<span class="op">=</span><span class="st">"AA"</span>,colorScheme<span class="op">=</span><span class="st">"chemistry"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motif</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/AAseqLogo-1.png" alt="Plot an sequence logo with any symbols as you want such as amino acid sequence logo" width="576"><p class="caption">
Plot an sequence logo with any symbols as you want such as amino acid
sequence logo
</p>
</div>
</div>
<div class="section level3">
<h3 id="plot-an-affinity-logo">plot an affinity logo<a class="anchor" aria-label="anchor" href="#plot-an-affinity-logo"></a>
</h3>
<p>It can also be used to draw affinity logos given a position specific
affinity matrix (PSAM) as described by Foat et al.<span class="citation"><sup>2</sup></span>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">motifStack</span><span class="op">)</span></span>
<span><span class="va">motif</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">.846</span>, <span class="fl">.631</span>, <span class="fl">.593</span>, <span class="fl">.000</span>, <span class="fl">.000</span>, <span class="fl">.000</span>, <span class="fl">.434</span>, <span class="fl">.410</span>, <span class="fl">1.00</span>, <span class="fl">.655</span>, <span class="fl">.284</span>, <span class="fl">.000</span>, <span class="fl">.000</span>, <span class="fl">.771</span>, <span class="fl">.640</span>, <span class="fl">.961</span>,</span>
<span>    <span class="fl">.625</span>, <span class="fl">.679</span>, <span class="fl">.773</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">.000</span>, <span class="fl">.573</span>, <span class="fl">.238</span>, <span class="fl">.397</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">.000</span>, <span class="fl">.298</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">.996</span>,</span>
<span>    <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">.228</span>, <span class="fl">.000</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">.597</span>, <span class="fl">.622</span>, <span class="fl">.630</span>, <span class="fl">.000</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">.871</span>, <span class="fl">.617</span>, <span class="fl">1.00</span>,</span>
<span>    <span class="fl">.701</span>, <span class="fl">.513</span>, <span class="fl">.658</span>, <span class="fl">.000</span>, <span class="fl">.000</span>, <span class="fl">.247</span>, <span class="fl">.542</span>, <span class="fl">1.00</span>, <span class="fl">.718</span>, <span class="fl">.686</span>, <span class="fl">.000</span>, <span class="fl">.000</span>, <span class="fl">.000</span>, <span class="fl">.595</span>, <span class="fl">.437</span>, <span class="fl">.970</span></span>
<span>  <span class="op">)</span>, nrow<span class="op">=</span><span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">motif</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span><span class="op">)</span></span>
<span><span class="va">motif</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"psam"</span>, mat<span class="op">=</span><span class="va">motif</span>, name<span class="op">=</span><span class="st">"affinity logo"</span>, </span>
<span>           markers<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"marker"</span>, type<span class="op">=</span><span class="st">"rect"</span>,</span>
<span>                            start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">11</span><span class="op">)</span>, stop<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">13</span><span class="op">)</span>,</span>
<span>                            gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"#009E73"</span>, fill<span class="op">=</span><span class="cn">NA</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pcm-class.html">plot</a></span><span class="op">(</span><span class="va">motif</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/affinityLogo-1.png" alt="Plot an affinity logo" width="576"><p class="caption">
Plot an affinity logo
</p>
</div>
</div>
<div class="section level3">
<h3 id="plot-sequence-logo-stack">plot sequence logo stack<a class="anchor" aria-label="anchor" href="#plot-sequence-logo-stack"></a>
</h3>
<p>To show multiple motifs on the same canvas as a sequence logo stack,
the distance of motifs need to be calculated first. Previously,
MotIV<span class="citation"><sup>3</sup></span>::<code>motifDistances</code> ( R
implementation of STAMP<span class="citation"><sup>4</sup></span>) is
used to calculate the distance. However, The MotIV package were dropped
from Bioconductor 3_12. Currently, by default, R implementation of
matalign is used. After alignment, users can use
<code>plotMotifLogoStack</code>, <code>plotMotifLogoStackWithTree</code>
or <code>plotMotifStackWithRadialPhylog</code> to draw sequence logos in
different layouts. To make it easy to use, we integrated different
functionalities into one workflow function named as
<code>motifStack</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">motifStack</span><span class="op">)</span></span>
<span><span class="co">#####Input#####</span></span>
<span><span class="va">motifs</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/importMatrix.html">importMatrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">find.package</a></span><span class="op">(</span><span class="st">"motifStack"</span><span class="op">)</span>,</span>
<span>                                   <span class="st">"extdata"</span><span class="op">)</span>,<span class="st">"pcm$"</span>, </span>
<span>                         full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## plot stacks</span></span>
<span><span class="fu"><a href="../reference/motifStack.html">motifStack</a></span><span class="op">(</span><span class="va">motifs</span>, layout<span class="op">=</span><span class="st">"stack"</span>, ncex<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/logostack-1.png" alt="Plot motifs with sequence logo stack style" width="384"><p class="caption">
Plot motifs with sequence logo stack style
</p>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rnaMotifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DNAmotifToRNAmotif.html">DNAmotifToRNAmotif</a></span><span class="op">(</span><span class="va">motifs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">rnaMotifs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "bin_SOLEXA"   "fd64A_SOLEXA" "fkh_NAR"      "foxo_SOLEXA"  "FoxP_SOLEXA" </span></span>
<span><span class="co">## [6] "slp1_SOLEXA"  "slp2_SOLEXA"</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/motifStack.html">motifStack</a></span><span class="op">(</span><span class="va">rnaMotifs</span>, layout <span class="op">=</span> <span class="st">"stack"</span>, </span>
<span>           reorder<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co">## we can also use reorder=FALSE to keep the order of input. </span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/rnalogostack-1.png" alt="Plot RNA motifs with sequence logo stack style" width="384"><p class="caption">
Plot RNA motifs with sequence logo stack style
</p>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">motif2</span> <span class="op">&lt;-</span> <span class="va">motif</span></span>
<span><span class="va">motif2</span><span class="op">$</span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="va">motif</span><span class="op">$</span><span class="va">mat</span><span class="op">[</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span></span>
<span><span class="va">motif2</span><span class="op">$</span><span class="va">name</span> <span class="op">&lt;-</span> <span class="st">"logo2"</span></span>
<span><span class="va">psamMotifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">motif</span>, <span class="va">motif2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/motifStack.html">motifStack</a></span><span class="op">(</span><span class="va">psamMotifs</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/logostack2-1.png" alt="Plot affinity logos with sequence logo stack style" width="384"><p class="caption">
Plot affinity logos with sequence logo stack style
</p>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## plot stacks with hierarchical tree</span></span>
<span><span class="fu"><a href="../reference/motifStack.html">motifStack</a></span><span class="op">(</span><span class="va">motifs</span>, layout<span class="op">=</span><span class="st">"tree"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/treestack-1.png" alt="Sequence logo stack with hierarchical cluster tree" width="480"><p class="caption">
Sequence logo stack with hierarchical cluster tree
</p>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## When the number of motifs is too much to be shown in a vertical stack, </span></span>
<span><span class="co">## motifStack can draw them in a radial style.</span></span>
<span><span class="co">## random sample from MotifDb</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"MotifDb"</span><span class="op">)</span></span>
<span><span class="va">matrix.fly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MotifDb/man/query.html" class="external-link">query</a></span><span class="op">(</span><span class="va">MotifDb</span>, <span class="st">"Dmelanogaster"</span><span class="op">)</span></span>
<span><span class="va">motifs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">matrix.fly</span><span class="op">)</span></span>
<span><span class="co">## use data from FlyFactorSurvey</span></span>
<span><span class="va">motifs2</span> <span class="op">&lt;-</span> <span class="va">motifs2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Dmelanogaster\\-FlyFactorSurvey\\-"</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">motifs2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">## format the names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">motifs2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"Dmelanogaster_FlyFactorSurvey_"</span>, <span class="st">""</span>,</span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"_FBgn\\d+$"</span>, <span class="st">""</span>,</span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"[^a-zA-Z0-9]"</span>,<span class="st">"_"</span>,</span>
<span>                                 <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"(_\\d+)+$"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">motifs2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">motifs2</span> <span class="op">&lt;-</span> <span class="va">motifs2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">motifs2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">pfms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">motifs2</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="co">## creat a list of object of pfm </span></span>
<span><span class="va">motifs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="va">pfms</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pfms</span><span class="op">)</span>, FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">.ele</span>, <span class="va">.name</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"pfm"</span>,mat<span class="op">=</span><span class="va">.ele</span>, name<span class="op">=</span><span class="va">.name</span><span class="op">)</span><span class="op">}</span>, SIMPLIFY <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">## trim the motifs</span></span>
<span><span class="va">motifs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">motifs2</span>, <span class="va">trimMotif</span>, t<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="co">## setting colors</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span>
<span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">"Set3"</span><span class="op">)</span></span>
<span><span class="co">## plot logo stack with radial style</span></span>
<span><span class="fu"><a href="../reference/motifStack.html">motifStack</a></span><span class="op">(</span><span class="va">motifs2</span>, layout<span class="op">=</span><span class="st">"radialPhylog"</span>, </span>
<span>           circle<span class="op">=</span><span class="fl">0.3</span>, cleaves <span class="op">=</span> <span class="fl">0.2</span>, </span>
<span>           clabel.leaves <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>           col.bg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">color</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, col.bg.alpha<span class="op">=</span><span class="fl">0.3</span>, </span>
<span>           col.leaves<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">color</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>           col.inner.label.circle<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">color</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, </span>
<span>           inner.label.circle.width<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>           col.outer.label.circle<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">color</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, </span>
<span>           outer.label.circle.width<span class="op">=</span><span class="fl">0.02</span>, </span>
<span>           circle.motif<span class="op">=</span><span class="fl">1.2</span>,</span>
<span>           angle<span class="op">=</span><span class="fl">350</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/radialstack-1.png" alt="Plot motifs in a radial style when the number of motifs is too much to be shown in a vertical stack" width="576"><p class="caption">
Plot motifs in a radial style when the number of motifs is too much to
be shown in a vertical stack
</p>
</div>
</div>
<div class="section level3">
<h3 id="plot-a-sequence-logo-cloud">plot a sequence logo cloud<a class="anchor" aria-label="anchor" href="#plot-a-sequence-logo-cloud"></a>
</h3>
<p>We can also plot a sequence logo cloud for DNA motifs.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## assign groups for motifs</span></span>
<span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"group"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">groups</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pfms</span><span class="op">)</span></span>
<span><span class="co">## assign group colors</span></span>
<span><span class="va">group.col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"Set3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">group.col</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"group"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="co">## create a list of pfm objects</span></span>
<span><span class="va">pfms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pfms</span><span class="op">)</span>, <span class="va">pfms</span>, FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">.ele</span>, <span class="va">.pfm</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"pfm"</span>,mat<span class="op">=</span><span class="va">.pfm</span>, name<span class="op">=</span><span class="va">.ele</span><span class="op">)</span><span class="op">}</span></span>
<span>               ,SIMPLIFY <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">## use matalign to calculate the distances of motifs</span></span>
<span><span class="va">hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clusterMotifs.html">clusterMotifs</a></span><span class="op">(</span><span class="va">pfms</span><span class="op">)</span></span>
<span><span class="co">## convert the hclust to phylog object</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/" class="external-link">ade4</a></span><span class="op">)</span></span>
<span><span class="va">phylog</span> <span class="op">&lt;-</span> <span class="fu">ade4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/newick2phylog.html" class="external-link">hclust2phylog</a></span><span class="op">(</span><span class="va">hc</span><span class="op">)</span></span>
<span><span class="co">## reorder the pfms by the order of hclust</span></span>
<span><span class="va">leaves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phylog</span><span class="op">$</span><span class="va">leaves</span><span class="op">)</span></span>
<span><span class="va">pfms</span> <span class="op">&lt;-</span> <span class="va">pfms</span><span class="op">[</span><span class="va">leaves</span><span class="op">]</span></span>
<span><span class="co">## extract the motif signatures</span></span>
<span><span class="va">motifSig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/motifSignature.html">motifSignature</a></span><span class="op">(</span><span class="va">pfms</span>, <span class="va">phylog</span>, cutoffPval<span class="op">=</span><span class="fl">0.0001</span>, min.freq<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">## draw the motifs with a tag-cloud style.</span></span>
<span><span class="fu"><a href="../reference/motifCloud.html">motifCloud</a></span><span class="op">(</span><span class="va">motifSig</span>, scale<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">.5</span><span class="op">)</span>, </span>
<span>           layout<span class="op">=</span><span class="st">"rectangles"</span>, </span>
<span>           group.col<span class="op">=</span><span class="va">group.col</span>, </span>
<span>           groups<span class="op">=</span><span class="va">groups</span>, </span>
<span>           draw.legend<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/motifCloud-1.png" alt="Sequence logo cloud with rectangle packing layout" width="576"><p class="caption">
Sequence logo cloud with rectangle packing layout
</p>
</div>
</div>
<div class="section level3">
<h3 id="plot-grouped-sequence-logo">plot grouped sequence logo<a class="anchor" aria-label="anchor" href="#plot-grouped-sequence-logo"></a>
</h3>
<p>Grouped sequence logo can also be plotted in radial phylogeny tree
style.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## get the signatures from object of motifSignature</span></span>
<span><span class="va">sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/motifSig-class.html">signatures</a></span><span class="op">(</span><span class="va">motifSig</span><span class="op">)</span></span>
<span><span class="co">## set the inner-circle color for each signature</span></span>
<span><span class="va">gpCol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/motifSig-class.html">sigColor</a></span><span class="op">(</span><span class="va">motifSig</span><span class="op">)</span></span>
<span><span class="co">## plot the logo stack with radial style.</span></span>
<span><span class="fu"><a href="../reference/plotMotifStackWithRadialPhylog.html">plotMotifStackWithRadialPhylog</a></span><span class="op">(</span>phylog<span class="op">=</span><span class="va">phylog</span>, pfms<span class="op">=</span><span class="va">sig</span>, </span>
<span>                              circle<span class="op">=</span><span class="fl">0.4</span>, cleaves <span class="op">=</span> <span class="fl">0.3</span>, </span>
<span>                              clabel.leaves <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                              col.bg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">color</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, col.bg.alpha<span class="op">=</span><span class="fl">0.3</span>, </span>
<span>                              col.leaves<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">color</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>                              col.inner.label.circle<span class="op">=</span><span class="va">gpCol</span>, </span>
<span>                              inner.label.circle.width<span class="op">=</span><span class="fl">0.03</span>,</span>
<span>                              angle<span class="op">=</span><span class="fl">350</span>, circle.motif<span class="op">=</span><span class="fl">1.2</span>, </span>
<span>                              motifScale<span class="op">=</span><span class="st">"logarithmic"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/motifRadialPhylog-1.png" alt="Grouped sequence logo with radialPhylog style layout" width="576"><p class="caption">
Grouped sequence logo with radialPhylog style layout
</p>
</div>
</div>
<div class="section level3">
<h3 id="motifcircos">motifCircos<a class="anchor" aria-label="anchor" href="#motifcircos"></a>
</h3>
<p>We can also plot it with circos style. In circos style, we can plot
two group of motifs and with multiple color rings.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## plot the logo stack with cirsoc style.</span></span>
<span><span class="fu"><a href="../reference/motifCircos.html">motifCircos</a></span><span class="op">(</span>phylog<span class="op">=</span><span class="va">phylog</span>, pfms<span class="op">=</span><span class="va">pfms</span>, pfms2<span class="op">=</span><span class="va">sig</span>, </span>
<span>            col.tree.bg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">color</span>, each<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, col.tree.bg.alpha<span class="op">=</span><span class="fl">0.3</span>, </span>
<span>            col.leaves<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">color</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>            col.inner.label.circle<span class="op">=</span><span class="va">gpCol</span>, </span>
<span>            inner.label.circle.width<span class="op">=</span><span class="fl">0.03</span>,</span>
<span>            col.outer.label.circle<span class="op">=</span><span class="va">gpCol</span>, </span>
<span>            outer.label.circle.width<span class="op">=</span><span class="fl">0.03</span>,</span>
<span>            r.rings<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span><span class="op">)</span>, </span>
<span>            col.rings<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colors.html" class="external-link">colors</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">30</span><span class="op">)</span>, </span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colors.html" class="external-link">colors</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">30</span><span class="op">)</span>, </span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colors.html" class="external-link">colors</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            angle<span class="op">=</span><span class="fl">350</span>, motifScale<span class="op">=</span><span class="st">"logarithmic"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/motifCircos-1.png" alt="Grouped sequence logo with circos style layout" width="576"><p class="caption">
Grouped sequence logo with circos style layout
</p>
</div>
</div>
<div class="section level3">
<h3 id="motifpiles">motifPiles<a class="anchor" aria-label="anchor" href="#motifpiles"></a>
</h3>
<p>We can also plot the motifs in pile style. In pile style, we can plot
two group of motifs with multiple types of annotation, for example
heatmap. The <em>col.anno</em> parameter should be set as a named
list.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## plot the logo stack with heatmap.</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>A<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>, B<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>, C<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>, D<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">map2col</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">pal</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">rg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">pal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/findInterval.html" class="external-link">findInterval</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">rg</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">rg</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pal</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>                   all.inside <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="va">dl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">map2col</span>, pal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">heat.colors</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## alignment of the pfms, this step will make the motif logos occupy </span></span>
<span><span class="co">## more space. Users can skip this alignment to see the difference.</span></span>
<span><span class="va">pfmsAligned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DNAmotifAlignment.html">DNAmotifAlignment</a></span><span class="op">(</span><span class="va">pfms</span><span class="op">)</span></span>
<span><span class="co">## plot motifs</span></span>
<span><span class="fu"><a href="../reference/motifPiles.html">motifPiles</a></span><span class="op">(</span>phylog<span class="op">=</span><span class="va">phylog</span>, pfms<span class="op">=</span><span class="va">pfmsAligned</span>, </span>
<span>            col.tree<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">color</span>, each<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>            col.leaves<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">color</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>            col.pfms2<span class="op">=</span><span class="va">gpCol</span>, </span>
<span>            r.anno<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dl</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            col.anno<span class="op">=</span><span class="va">dl</span>,</span>
<span>            motifScale<span class="op">=</span><span class="st">"logarithmic"</span>,</span>
<span>            plotIndex<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>            groupDistance<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="motifStack_HTML_files/figure-html/motifPilesHeatmap-1.png" alt="Grouped sequence logo with a heatmap" width="576"><p class="caption">
Grouped sequence logo with a heatmap
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="plot-motifs-with-d3-js">plot motifs with d3.js<a class="anchor" aria-label="anchor" href="#plot-motifs-with-d3-js"></a>
</h2>
<p>Interactive plot can be generated using <code>browseMotifs</code>
function which leverages the <strong>d3.js</strong> library. All motifs
on the plot are draggable and the plot can be easily exported as a
<strong>Scalable Vector Graphics (SVG)</strong> file.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/browseMotifs.html">browseMotifs</a></span><span class="op">(</span>pfms <span class="op">=</span> <span class="va">pfms</span>, phylog <span class="op">=</span> <span class="va">phylog</span>, layout<span class="op">=</span><span class="st">"tree"</span>, yaxis <span class="op">=</span> <span class="cn">FALSE</span>, baseWidth<span class="op">=</span><span class="fl">6</span>, baseHeight <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-5381426bfa5e6dbf9275" style="width:768px;height:768px;" class="browseMotifs html-widget"></div>
<script type="application/json" data-for="htmlwidget-5381426bfa5e6dbf9275">{"x":{"elements":{"name":"Root","children":[{"name":"HLHm7_SANGER_5","motif":[[[0,0.0555555555555556,0.888888888888889,0.0555555555555556],[0,1,0,0],[0.947368421052632,0,0.0526315789473684,0],[0,1,0,0],[0,0,1,0],[0.105263157894737,0,0,0.894736842105263],[0,0,1,0],[0,0.894736842105263,0.0526315789473684,0.0526315789473684],[0,0.947368421052632,0.0526315789473684,0],[0.894736842105263,0.0526315789473684,0.0526315789473684,0],[0.631578947368421,0.263157894736842,0.105263157894737,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":72,"height":15,"xaxis":true,"yaxis":false},{"name":"Int28","children":[{"name":"Int21","children":[{"name":"Int14","children":[{"name":"Int9","children":[{"name":"CG11085_SOLEXA","motif":[[[0.163120567375887,0.281323877068558,0.245862884160756,0.309692671394799],[0.212765957446809,0.217494089834515,0.0874704491725768,0.482269503546099],[0.0236406619385343,0.00472813238770686,0.00236406619385343,0.969267139479905],[0.936170212765957,0,0.00472813238770686,0.0591016548463357],[0.997635933806147,0,0.00236406619385343,0],[0.333333333333333,0,0.0756501182033097,0.591016548463357],[0.08274231678487,0.278959810874705,0.174940898345154,0.463356973995272],[0.219858156028369,0.00709219858156028,0.647754137115839,0.125295508274232],[0.16548463356974,0.286052009456265,0.380614657210402,0.167848699763593],[0.15839243498818,0.347517730496454,0.141843971631206,0.352245862884161]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":66,"height":15,"xaxis":true,"yaxis":false},{"name":"Int4","children":[{"name":"Ems_SOLEXA","motif":[[[0.0794979079497908,0.391213389121339,0.112970711297071,0.416317991631799],[0.0230125523012552,0.00836820083682008,0.0523012552301255,0.916317991631799],[0.945606694560669,0.0271966527196653,0.0188284518828452,0.00836820083682008],[0.972803347280335,0.0271966527196653,0,0],[0.0167364016736402,0.00627615062761506,0.0878661087866109,0.889121338912134],[0.0878661087866109,0.00627615062761506,0.303347280334728,0.602510460251046],[0.738493723849372,0.0188284518828452,0.230125523012552,0.0125523012552301]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":48,"height":15,"xaxis":true,"yaxis":false},{"name":"Bsh_SOLEXA","motif":[[[0.216035634743875,0.242761692650334,0.130660727542687,0.410541945063103],[0.0155902004454343,0,0.0252412769116555,0.95916852264291],[0.967334818114328,0.0148478099480327,0.00593912397921307,0.0118782479584261],[0.979955456570156,0.0126206384558278,0.00742390497401633,0],[0.0126206384558278,0.133630289532294,0.0408314773570898,0.812917594654788],[0.0178173719376392,0.152190051967335,0.438752783964365,0.391239792130661],[0.578322197475872,0.0111358574610245,0.357832219747587,0.052709725315516]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":48,"height":15,"xaxis":true,"yaxis":false}]}]},{"name":"Int10","children":[{"name":"En_SOLEXA","motif":[[[0.152329749103943,0.224611708482676,0.127240143369176,0.495818399044205],[0.106332138590203,0.01194743130227,0,0.881720430107527],[0.753285543608124,0,0.126045400238949,0.120669056152927],[1,0,0,0],[0.0017921146953405,0,0,0.99820788530466],[0.0525686977299881,0.00896057347670251,0.154719235364397,0.783751493428913],[0.593189964157706,0,0.406810035842294,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":48,"height":15,"xaxis":true,"yaxis":false},{"name":"Int6","children":[{"name":"CG18599_Cell","motif":[[[0.16,0.4,0.04,0.4],[0,0,0,1],[1,0,0,0],[1,0,0,0],[0,0,0,1],[0,0.04,0.32,0.64],[0.92,0,0.08,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":48,"height":15,"xaxis":true,"yaxis":false},{"name":"Int5","children":[{"name":"Ro_SOLEXA","motif":[[[0.189024390243902,0.289634146341463,0.109756097560976,0.411585365853659],[0.00914634146341463,0,0,0.990853658536585],[0.972560975609756,0.00609756097560976,0.00609756097560976,0.0152439024390244],[0.996951219512195,0,0.00304878048780488,0],[0.00609756097560976,0,0.00304878048780488,0.990853658536585],[0.00304878048780488,0.0152439024390244,0.152439024390244,0.829268292682927],[0.704268292682927,0.00609756097560976,0.286585365853659,0.00304878048780488]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":48,"height":15,"xaxis":true,"yaxis":false},{"name":"pdm3_SOLEXA_5","motif":[[[0.144364869958538,0.253675084809649,0.237843950245006,0.364116094986807],[0.051262721447418,0.00414624952883528,0,0.944591029023747],[0.993215228043724,0,0.00414624952883528,0.00263852242744063],[0.996230682246513,0.00376931775348662,0,0],[0.00188465887674331,0,0.0422163588390501,0.955898982284207],[0.0606860158311346,0.0942329438371655,0.333961552958914,0.511119487372786],[0.525065963060686,0.137203166226913,0.203920090463626,0.133810780248775],[0.0821711270260083,0.171503957783641,0.587636637768564,0.158688277421787],[0.121748963437618,0.234074632491519,0.406332453825858,0.237843950245006],[0.175273275537128,0.208066339992461,0.20278929513758,0.413871089332831],[0.258952129664531,0.18582736524689,0.269883151149642,0.285337353938937],[0.18582736524689,0.174142480211082,0.349038823972861,0.290991330569167],[0.111948737278553,0.207689408217113,0.35205427817565,0.328307576328685],[0.106294760648323,0.226159065209197,0.275160196004523,0.392385978137957],[0.242744063324538,0.18582736524689,0.24236713154919,0.329061439879382],[0.136072370900867,0.212589521296645,0.366377685638899,0.284960422163588],[0.192989068978515,0.210327930644553,0.307199396909159,0.289483603467772],[0.194873727855258,0.23671315491896,0.287975876366378,0.280437240859404],[0.169619298906898,0.218997361477573,0.302299283829627,0.309084055785903],[0.130795326045986,0.204673954014323,0.40557859027516,0.258952129664531],[0.1549189596683,0.230305314738032,0.358462118356577,0.25631360723709],[0.190727478326423,0.226159065209197,0.311345646437995,0.271767810026385],[0.168488503580852,0.209197135318507,0.346777233320769,0.275537127779872],[0.16057293629853,0.209197135318507,0.366000753863551,0.264229174519412],[0.185325264750378,0.215582450832073,0.316944024205749,0.2821482602118]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":156,"height":15,"xaxis":true,"yaxis":false}]}]}]}]},{"name":"Int19","children":[{"name":"Hmx_Cell","motif":[[[0.05,0.15,0,0.8],[0,0,0,1],[1,0,0,0],[1,0,0,0],[0.05,0,0,0.95],[0,0.15,0,0.85],[0.2,0,0.8,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":48,"height":15,"xaxis":true,"yaxis":false},{"name":"Int13","children":[{"name":"prd_FlyReg","motif":[[[0.181818181818182,0.818181818181818,0,0],[0.454545454545455,0.454545454545455,0.0909090909090909,0],[0.818181818181818,0,0.181818181818182,0],[0,0,0,1],[0.0909090909090909,0,0.181818181818182,0.727272727272727],[0.727272727272727,0.0909090909090909,0,0.181818181818182],[0.181818181818182,0.636363636363636,0,0.181818181818182],[0.181818181818182,0.363636363636364,0.363636363636364,0.0909090909090909]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false},{"name":"Int8","children":[{"name":"Oc_SOLEXA","motif":[[[0.179487179487179,0.313186813186813,0.141025641025641,0.366300366300366],[0.021978021978022,0,0.043956043956044,0.934065934065934],[0.941391941391941,0.0476190476190476,0,0.010989010989011],[0.904761904761905,0.0952380952380952,0,0],[0,0,0.0934065934065934,0.906593406593407],[0.00549450549450549,0.93040293040293,0,0.0641025641025641],[0.0488322717622081,0.709129511677282,0.0382165605095541,0.203821656050955],[0.121212121212121,0.390572390572391,0.2996632996633,0.188552188552189]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false},{"name":"C15_Cell","motif":[[[0.105263157894737,0.210526315789474,0.421052631578947,0.263157894736842],[0.0526315789473684,0.0526315789473684,0,0.894736842105263],[0,0,0,1],[0.894736842105263,0,0,0.105263157894737],[1,0,0,0],[0.315789473684211,0.105263157894737,0,0.578947368421053],[0,0.157894736842105,0.315789473684211,0.526315789473684],[0.526315789473684,0,0.473684210526316,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false}]}]}]}]},{"name":"Int27","children":[{"name":"Int17","children":[{"name":"Int12","children":[{"name":"Vis_SOLEXA","motif":[[[0.192090395480226,0.149717514124294,0.096045197740113,0.562146892655367],[0,0,0,1],[0,0,0.963276836158192,0.0367231638418079],[1,0,0,0],[0,1,0,0],[0.898305084745763,0,0.101694915254237,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":42,"height":15,"xaxis":true,"yaxis":false},{"name":"Exd_SOLEXA","motif":[[[0.292185730464326,0.172140430351076,0.234428086070215,0.301245753114383],[0.181200453001132,0.194790486976217,0.161947904869762,0.462061155152888],[0.151755379388448,0.0453001132502831,0.190260475651189,0.612684031710079],[0,0,0,1],[0,0,1,0],[1,0,0,0],[0.0622876557191393,0.571913929784824,0,0.365798414496036],[0.590033975084938,0.029445073612684,0.293318233295583,0.087202718006795]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false}]},{"name":"Int16","children":[{"name":"So_SOLEXA","motif":[[[0.31638418079096,0.192090395480226,0.178907721280603,0.312617702448211],[0.295668549905838,0.173258003766478,0.220338983050847,0.310734463276836],[0.322033898305085,0.163841807909605,0.284369114877589,0.229755178907721],[0.00376647834274953,0.109227871939736,0.00753295668549906,0.879472693032015],[0.0225988700564972,0,0.977401129943503,0],[1,0,0,0],[0,0.0150659133709981,0.0263653483992467,0.958568738229755],[1,0,0,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false},{"name":"Int2","children":[{"name":"Mirr_Cell","motif":[[[0.439024390243902,0.146341463414634,0.146341463414634,0.268292682926829],[0.439024390243902,0.0975609756097561,0.24390243902439,0.219512195121951],[0.536585365853659,0.170731707317073,0.146341463414634,0.146341463414634],[0.48780487804878,0.024390243902439,0.024390243902439,0.463414634146341],[0.707317073170732,0,0.0487804878048781,0.24390243902439],[1,0,0,0],[0,1,0,0],[1,0,0,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false},{"name":"CG11617_SOLEXA","motif":[[[0.319240724762726,0.173425366695427,0.182053494391717,0.325280414150129],[0.242450388265746,0.226056945642796,0.221742881794651,0.309749784296808],[0.303710094909405,0.151855047454702,0.151855047454702,0.392579810181191],[0.114754098360656,0.144089732528041,0.0172562553925798,0.723899913718723],[0.416738567730802,0,0.244176013805004,0.339085418464193],[1,0,0,0],[0.00603968938740293,0.993960310612597,0,0],[0.990509059534081,0.00172562553925798,0.00776531492666091,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false}]}]}]},{"name":"Int26","children":[{"name":"Int22","children":[{"name":"Mio_bigmax_SANGER_5","motif":[[[0.6,0,0.2,0.2],[0,0,0.2,0.8],[0,1,0,0],[1,0,0,0],[0,0.95,0,0.05],[0,0,0.9,0.1],[0,0.2,0.05,0.75],[0.1,0,0.85,0.05]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false},{"name":"Int18","children":[{"name":"tgo_sima_SANGER_5","motif":[[[0.19047619047619,0.142857142857143,0.666666666666667,0],[0,0.136363636363636,0.136363636363636,0.727272727272727],[0.954545454545455,0,0.0454545454545455,0],[0,1,0,0],[0,0,1,0],[0,0,0,1],[0,0,1,0],[0.909090909090909,0.0909090909090909,0,0],[0,0.954545454545455,0.0454545454545455,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":60,"height":15,"xaxis":true,"yaxis":false},{"name":"disco_SANGER_5","motif":[[[0.526315789473684,0.0526315789473684,0.105263157894737,0.315789473684211],[0.6,0,0.2,0.2],[0.25,0,0.4,0.35],[0,0,0,1],[0.0526315789473684,0,0.947368421052632,0],[0,0,0,1],[0,1,0,0],[0.9,0,0.05,0.05],[0,1,0,0],[0.25,0.7,0.05,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":66,"height":15,"xaxis":true,"yaxis":false}]}]},{"name":"Int25","children":[{"name":"Int23","children":[{"name":"Int1","children":[{"name":"crp_SANGER_10","motif":[[[0.411764705882353,0.176470588235294,0.411764705882353,0],[0.666666666666667,0.111111111111111,0.0555555555555556,0.166666666666667],[0.388888888888889,0.388888888888889,0.0555555555555556,0.166666666666667],[0,1,0,0],[1,0,0,0],[0,0,0.833333333333333,0.166666666666667],[0.222222222222222,0.777777777777778,0,0],[0,0,0,1],[0,0,1,0],[0.888888888888889,0,0.111111111111111,0],[0,0.388888888888889,0.0555555555555556,0.555555555555556]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":72,"height":15,"xaxis":true,"yaxis":false},{"name":"her_SANGER_10","motif":[[[0.5,0.0714285714285714,0.428571428571429,0],[0.0714285714285714,0.857142857142857,0.0714285714285714,0],[0,0.0333333333333333,0.966666666666667,0],[0.133333333333333,0.5,0.333333333333333,0.0333333333333333],[0.633333333333333,0.2,0.133333333333333,0.0333333333333333],[0.433333333333333,0.0333333333333333,0.233333333333333,0.3],[0.3,0.133333333333333,0.133333333333333,0.433333333333333],[0.266666666666667,0.166666666666667,0.1,0.466666666666667],[0.433333333333333,0.0666666666666667,0.333333333333333,0.166666666666667],[0,0,0,1],[0,0,1,0],[0.933333333333333,0,0.0666666666666667,0],[0,0,1,0],[0.133333333333333,0.333333333333333,0,0.533333333333333],[0.517241379310345,0.241379310344828,0.0344827586206897,0.206896551724138]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":96,"height":15,"xaxis":true,"yaxis":false}]},{"name":"Int11","children":[{"name":"D19B_F10_12_SANGER_5","motif":[[[0,0.111111111111111,0,0.888888888888889],[0.666666666666667,0.111111111111111,0.222222222222222,0],[0,0.888888888888889,0,0.111111111111111],[1,0,0,0],[0,0,1,0],[0,0,1,0],[0,0,0.888888888888889,0.111111111111111],[0.111111111111111,0,0,0.888888888888889],[1,0,0,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":60,"height":15,"xaxis":true,"yaxis":false},{"name":"Int3","children":[{"name":"Kr_NAR","motif":[[[0.0967741935483871,0.548387096774194,0.161290322580645,0.193548387096774],[0.354838709677419,0.129032258064516,0.32258064516129,0.193548387096774],[0.774193548387097,0,0.225806451612903,0],[0.967741935483871,0,0,0.032258064516129],[0.580645161290323,0.193548387096774,0.225806451612903,0],[0,0,1,0],[0.0645161290322581,0,0.935483870967742,0],[0.0645161290322581,0,0.935483870967742,0],[0,0.032258064516129,0.225806451612903,0.741935483870968],[0.129032258064516,0,0.161290322580645,0.709677419354839],[0.645161290322581,0.129032258064516,0.0967741935483871,0.129032258064516]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":72,"height":15,"xaxis":true,"yaxis":false},{"name":"CG12768_SANGER_5","motif":[[[0.347826086956522,0.0434782608695652,0,0.608695652173913],[0.260869565217391,0.260869565217391,0.173913043478261,0.304347826086957],[0,0.434782608695652,0,0.565217391304348],[0.0869565217391304,0.0434782608695652,0,0.869565217391304],[1,0,0,0],[0.0434782608695652,0.956521739130435,0,0],[0,1,0,0],[1,0,0,0],[1,0,0,0],[0.304347826086957,0.391304347826087,0,0.304347826086957],[0.434782608695652,0.391304347826087,0,0.173913043478261],[0.347826086956522,0.304347826086957,0,0.347826086956522]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":78,"height":15,"xaxis":true,"yaxis":false}]}]}]},{"name":"Int24","children":[{"name":"Tin_SOLEXA","motif":[[[0.110365853658537,0.343292682926829,0.210975609756098,0.335365853658537],[0.171951219512195,0.141463414634146,0.0298780487804878,0.656707317073171],[0.0341463414634146,0.419512195121951,0.0774390243902439,0.46890243902439],[0.926829268292683,0,0.0731707317073171,0],[1,0,0,0],[0,0,0.840853658536585,0.159146341463415],[0.123170731707317,0.024390243902439,0.0829268292682927,0.769512195121951],[0.400609756097561,0,0.595121951219512,0.00426829268292683]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false},{"name":"Int20","children":[{"name":"ftz_f1_SANGER_5","motif":[[[1,0,0,0],[1,0,0,0],[0,0,1,0],[0,0,1,0],[0,0,0,1],[0,1,0,0],[1,0,0,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":48,"height":15,"xaxis":true,"yaxis":false},{"name":"Int15","children":[{"name":"dl_FlyReg","motif":[[[0.0526315789473684,0.210526315789474,0.578947368421053,0.157894736842105],[0.210526315789474,0.105263157894737,0.684210526315789,0],[0.0789473684210526,0,0.894736842105263,0.0263157894736842],[0.868421052631579,0.0263157894736842,0.105263157894737,0],[0.894736842105263,0.0526315789473684,0,0.0526315789473684],[0.947368421052632,0,0.0263157894736842,0.0263157894736842],[0.631578947368421,0.0263157894736842,0.0526315789473684,0.289473684210526],[0.105263157894737,0.315789473684211,0.0789473684210526,0.5],[0.210526315789474,0.605263157894737,0.0526315789473684,0.131578947368421],[0.210526315789474,0.631578947368421,0.105263157894737,0.0526315789473684]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":66,"height":15,"xaxis":true,"yaxis":false},{"name":"Int7","children":[{"name":"Vnd_Cell","motif":[[[0.210526315789474,0,0.105263157894737,0.684210526315789],[0.0526315789473684,0.421052631578947,0.0526315789473684,0.473684210526316],[0,0,0,1],[0,0.789473684210526,0.105263157894737,0.105263157894737],[1,0,0,0],[1,0,0,0],[0,0,1,0],[0.105263157894737,0,0,0.894736842105263],[0.473684210526316,0,0.526315789473684,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":60,"height":15,"xaxis":true,"yaxis":false},{"name":"CG7386_F10_12_SANGER_5","motif":[[[0.111111111111111,0,0.888888888888889,0],[0,0,0,1],[0.222222222222222,0,0.777777777777778,0],[1,0,0,0],[1,0,0,0],[0.222222222222222,0.222222222222222,0.222222222222222,0.333333333333333],[0,0,1,0],[0.888888888888889,0.111111111111111,0,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":true,"yaxis":false}]}]}]}]}]}]}]}]}]},"nodeRadius":2.5,"maxH":15,"maxW":156,"layout":"tree"},"evals":[],"jsHooks":[]}</script><p>Plot the motifs in radialPhylog layout.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/browseMotifs.html">browseMotifs</a></span><span class="op">(</span>pfms <span class="op">=</span> <span class="va">pfms</span>, phylog <span class="op">=</span> <span class="va">phylog</span>, layout<span class="op">=</span><span class="st">"radialPhylog"</span>, yaxis <span class="op">=</span> <span class="cn">FALSE</span>, xaxis <span class="op">=</span> <span class="cn">FALSE</span>, baseWidth<span class="op">=</span><span class="fl">6</span>, baseHeight <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-c99c6f068e0bd9a9b804" style="width:768px;height:768px;" class="browseMotifs html-widget"></div>
<script type="application/json" data-for="htmlwidget-c99c6f068e0bd9a9b804">{"x":{"elements":{"name":"Root","children":[{"name":"HLHm7_SANGER_5","motif":[[[0,0.0555555555555556,0.888888888888889,0.0555555555555556],[0,1,0,0],[0.947368421052632,0,0.0526315789473684,0],[0,1,0,0],[0,0,1,0],[0.105263157894737,0,0,0.894736842105263],[0,0,1,0],[0,0.894736842105263,0.0526315789473684,0.0526315789473684],[0,0.947368421052632,0.0526315789473684,0],[0.894736842105263,0.0526315789473684,0.0526315789473684,0],[0.631578947368421,0.263157894736842,0.105263157894737,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":72,"height":15,"xaxis":false,"yaxis":false},{"name":"Int28","children":[{"name":"Int21","children":[{"name":"Int14","children":[{"name":"Int9","children":[{"name":"CG11085_SOLEXA","motif":[[[0.163120567375887,0.281323877068558,0.245862884160756,0.309692671394799],[0.212765957446809,0.217494089834515,0.0874704491725768,0.482269503546099],[0.0236406619385343,0.00472813238770686,0.00236406619385343,0.969267139479905],[0.936170212765957,0,0.00472813238770686,0.0591016548463357],[0.997635933806147,0,0.00236406619385343,0],[0.333333333333333,0,0.0756501182033097,0.591016548463357],[0.08274231678487,0.278959810874705,0.174940898345154,0.463356973995272],[0.219858156028369,0.00709219858156028,0.647754137115839,0.125295508274232],[0.16548463356974,0.286052009456265,0.380614657210402,0.167848699763593],[0.15839243498818,0.347517730496454,0.141843971631206,0.352245862884161]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":66,"height":15,"xaxis":false,"yaxis":false},{"name":"Int4","children":[{"name":"Ems_SOLEXA","motif":[[[0.0794979079497908,0.391213389121339,0.112970711297071,0.416317991631799],[0.0230125523012552,0.00836820083682008,0.0523012552301255,0.916317991631799],[0.945606694560669,0.0271966527196653,0.0188284518828452,0.00836820083682008],[0.972803347280335,0.0271966527196653,0,0],[0.0167364016736402,0.00627615062761506,0.0878661087866109,0.889121338912134],[0.0878661087866109,0.00627615062761506,0.303347280334728,0.602510460251046],[0.738493723849372,0.0188284518828452,0.230125523012552,0.0125523012552301]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":48,"height":15,"xaxis":false,"yaxis":false},{"name":"Bsh_SOLEXA","motif":[[[0.216035634743875,0.242761692650334,0.130660727542687,0.410541945063103],[0.0155902004454343,0,0.0252412769116555,0.95916852264291],[0.967334818114328,0.0148478099480327,0.00593912397921307,0.0118782479584261],[0.979955456570156,0.0126206384558278,0.00742390497401633,0],[0.0126206384558278,0.133630289532294,0.0408314773570898,0.812917594654788],[0.0178173719376392,0.152190051967335,0.438752783964365,0.391239792130661],[0.578322197475872,0.0111358574610245,0.357832219747587,0.052709725315516]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":48,"height":15,"xaxis":false,"yaxis":false}]}]},{"name":"Int10","children":[{"name":"En_SOLEXA","motif":[[[0.152329749103943,0.224611708482676,0.127240143369176,0.495818399044205],[0.106332138590203,0.01194743130227,0,0.881720430107527],[0.753285543608124,0,0.126045400238949,0.120669056152927],[1,0,0,0],[0.0017921146953405,0,0,0.99820788530466],[0.0525686977299881,0.00896057347670251,0.154719235364397,0.783751493428913],[0.593189964157706,0,0.406810035842294,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":48,"height":15,"xaxis":false,"yaxis":false},{"name":"Int6","children":[{"name":"CG18599_Cell","motif":[[[0.16,0.4,0.04,0.4],[0,0,0,1],[1,0,0,0],[1,0,0,0],[0,0,0,1],[0,0.04,0.32,0.64],[0.92,0,0.08,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":48,"height":15,"xaxis":false,"yaxis":false},{"name":"Int5","children":[{"name":"Ro_SOLEXA","motif":[[[0.189024390243902,0.289634146341463,0.109756097560976,0.411585365853659],[0.00914634146341463,0,0,0.990853658536585],[0.972560975609756,0.00609756097560976,0.00609756097560976,0.0152439024390244],[0.996951219512195,0,0.00304878048780488,0],[0.00609756097560976,0,0.00304878048780488,0.990853658536585],[0.00304878048780488,0.0152439024390244,0.152439024390244,0.829268292682927],[0.704268292682927,0.00609756097560976,0.286585365853659,0.00304878048780488]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":48,"height":15,"xaxis":false,"yaxis":false},{"name":"pdm3_SOLEXA_5","motif":[[[0.144364869958538,0.253675084809649,0.237843950245006,0.364116094986807],[0.051262721447418,0.00414624952883528,0,0.944591029023747],[0.993215228043724,0,0.00414624952883528,0.00263852242744063],[0.996230682246513,0.00376931775348662,0,0],[0.00188465887674331,0,0.0422163588390501,0.955898982284207],[0.0606860158311346,0.0942329438371655,0.333961552958914,0.511119487372786],[0.525065963060686,0.137203166226913,0.203920090463626,0.133810780248775],[0.0821711270260083,0.171503957783641,0.587636637768564,0.158688277421787],[0.121748963437618,0.234074632491519,0.406332453825858,0.237843950245006],[0.175273275537128,0.208066339992461,0.20278929513758,0.413871089332831],[0.258952129664531,0.18582736524689,0.269883151149642,0.285337353938937],[0.18582736524689,0.174142480211082,0.349038823972861,0.290991330569167],[0.111948737278553,0.207689408217113,0.35205427817565,0.328307576328685],[0.106294760648323,0.226159065209197,0.275160196004523,0.392385978137957],[0.242744063324538,0.18582736524689,0.24236713154919,0.329061439879382],[0.136072370900867,0.212589521296645,0.366377685638899,0.284960422163588],[0.192989068978515,0.210327930644553,0.307199396909159,0.289483603467772],[0.194873727855258,0.23671315491896,0.287975876366378,0.280437240859404],[0.169619298906898,0.218997361477573,0.302299283829627,0.309084055785903],[0.130795326045986,0.204673954014323,0.40557859027516,0.258952129664531],[0.1549189596683,0.230305314738032,0.358462118356577,0.25631360723709],[0.190727478326423,0.226159065209197,0.311345646437995,0.271767810026385],[0.168488503580852,0.209197135318507,0.346777233320769,0.275537127779872],[0.16057293629853,0.209197135318507,0.366000753863551,0.264229174519412],[0.185325264750378,0.215582450832073,0.316944024205749,0.2821482602118]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":156,"height":15,"xaxis":false,"yaxis":false}]}]}]}]},{"name":"Int19","children":[{"name":"Hmx_Cell","motif":[[[0.05,0.15,0,0.8],[0,0,0,1],[1,0,0,0],[1,0,0,0],[0.05,0,0,0.95],[0,0.15,0,0.85],[0.2,0,0.8,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":48,"height":15,"xaxis":false,"yaxis":false},{"name":"Int13","children":[{"name":"prd_FlyReg","motif":[[[0.181818181818182,0.818181818181818,0,0],[0.454545454545455,0.454545454545455,0.0909090909090909,0],[0.818181818181818,0,0.181818181818182,0],[0,0,0,1],[0.0909090909090909,0,0.181818181818182,0.727272727272727],[0.727272727272727,0.0909090909090909,0,0.181818181818182],[0.181818181818182,0.636363636363636,0,0.181818181818182],[0.181818181818182,0.363636363636364,0.363636363636364,0.0909090909090909]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false},{"name":"Int8","children":[{"name":"Oc_SOLEXA","motif":[[[0.179487179487179,0.313186813186813,0.141025641025641,0.366300366300366],[0.021978021978022,0,0.043956043956044,0.934065934065934],[0.941391941391941,0.0476190476190476,0,0.010989010989011],[0.904761904761905,0.0952380952380952,0,0],[0,0,0.0934065934065934,0.906593406593407],[0.00549450549450549,0.93040293040293,0,0.0641025641025641],[0.0488322717622081,0.709129511677282,0.0382165605095541,0.203821656050955],[0.121212121212121,0.390572390572391,0.2996632996633,0.188552188552189]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false},{"name":"C15_Cell","motif":[[[0.105263157894737,0.210526315789474,0.421052631578947,0.263157894736842],[0.0526315789473684,0.0526315789473684,0,0.894736842105263],[0,0,0,1],[0.894736842105263,0,0,0.105263157894737],[1,0,0,0],[0.315789473684211,0.105263157894737,0,0.578947368421053],[0,0.157894736842105,0.315789473684211,0.526315789473684],[0.526315789473684,0,0.473684210526316,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false}]}]}]}]},{"name":"Int27","children":[{"name":"Int17","children":[{"name":"Int12","children":[{"name":"Vis_SOLEXA","motif":[[[0.192090395480226,0.149717514124294,0.096045197740113,0.562146892655367],[0,0,0,1],[0,0,0.963276836158192,0.0367231638418079],[1,0,0,0],[0,1,0,0],[0.898305084745763,0,0.101694915254237,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":42,"height":15,"xaxis":false,"yaxis":false},{"name":"Exd_SOLEXA","motif":[[[0.292185730464326,0.172140430351076,0.234428086070215,0.301245753114383],[0.181200453001132,0.194790486976217,0.161947904869762,0.462061155152888],[0.151755379388448,0.0453001132502831,0.190260475651189,0.612684031710079],[0,0,0,1],[0,0,1,0],[1,0,0,0],[0.0622876557191393,0.571913929784824,0,0.365798414496036],[0.590033975084938,0.029445073612684,0.293318233295583,0.087202718006795]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false}]},{"name":"Int16","children":[{"name":"So_SOLEXA","motif":[[[0.31638418079096,0.192090395480226,0.178907721280603,0.312617702448211],[0.295668549905838,0.173258003766478,0.220338983050847,0.310734463276836],[0.322033898305085,0.163841807909605,0.284369114877589,0.229755178907721],[0.00376647834274953,0.109227871939736,0.00753295668549906,0.879472693032015],[0.0225988700564972,0,0.977401129943503,0],[1,0,0,0],[0,0.0150659133709981,0.0263653483992467,0.958568738229755],[1,0,0,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false},{"name":"Int2","children":[{"name":"Mirr_Cell","motif":[[[0.439024390243902,0.146341463414634,0.146341463414634,0.268292682926829],[0.439024390243902,0.0975609756097561,0.24390243902439,0.219512195121951],[0.536585365853659,0.170731707317073,0.146341463414634,0.146341463414634],[0.48780487804878,0.024390243902439,0.024390243902439,0.463414634146341],[0.707317073170732,0,0.0487804878048781,0.24390243902439],[1,0,0,0],[0,1,0,0],[1,0,0,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false},{"name":"CG11617_SOLEXA","motif":[[[0.319240724762726,0.173425366695427,0.182053494391717,0.325280414150129],[0.242450388265746,0.226056945642796,0.221742881794651,0.309749784296808],[0.303710094909405,0.151855047454702,0.151855047454702,0.392579810181191],[0.114754098360656,0.144089732528041,0.0172562553925798,0.723899913718723],[0.416738567730802,0,0.244176013805004,0.339085418464193],[1,0,0,0],[0.00603968938740293,0.993960310612597,0,0],[0.990509059534081,0.00172562553925798,0.00776531492666091,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false}]}]}]},{"name":"Int26","children":[{"name":"Int22","children":[{"name":"Mio_bigmax_SANGER_5","motif":[[[0.6,0,0.2,0.2],[0,0,0.2,0.8],[0,1,0,0],[1,0,0,0],[0,0.95,0,0.05],[0,0,0.9,0.1],[0,0.2,0.05,0.75],[0.1,0,0.85,0.05]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false},{"name":"Int18","children":[{"name":"tgo_sima_SANGER_5","motif":[[[0.19047619047619,0.142857142857143,0.666666666666667,0],[0,0.136363636363636,0.136363636363636,0.727272727272727],[0.954545454545455,0,0.0454545454545455,0],[0,1,0,0],[0,0,1,0],[0,0,0,1],[0,0,1,0],[0.909090909090909,0.0909090909090909,0,0],[0,0.954545454545455,0.0454545454545455,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":60,"height":15,"xaxis":false,"yaxis":false},{"name":"disco_SANGER_5","motif":[[[0.526315789473684,0.0526315789473684,0.105263157894737,0.315789473684211],[0.6,0,0.2,0.2],[0.25,0,0.4,0.35],[0,0,0,1],[0.0526315789473684,0,0.947368421052632,0],[0,0,0,1],[0,1,0,0],[0.9,0,0.05,0.05],[0,1,0,0],[0.25,0.7,0.05,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":66,"height":15,"xaxis":false,"yaxis":false}]}]},{"name":"Int25","children":[{"name":"Int23","children":[{"name":"Int1","children":[{"name":"crp_SANGER_10","motif":[[[0.411764705882353,0.176470588235294,0.411764705882353,0],[0.666666666666667,0.111111111111111,0.0555555555555556,0.166666666666667],[0.388888888888889,0.388888888888889,0.0555555555555556,0.166666666666667],[0,1,0,0],[1,0,0,0],[0,0,0.833333333333333,0.166666666666667],[0.222222222222222,0.777777777777778,0,0],[0,0,0,1],[0,0,1,0],[0.888888888888889,0,0.111111111111111,0],[0,0.388888888888889,0.0555555555555556,0.555555555555556]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":72,"height":15,"xaxis":false,"yaxis":false},{"name":"her_SANGER_10","motif":[[[0.5,0.0714285714285714,0.428571428571429,0],[0.0714285714285714,0.857142857142857,0.0714285714285714,0],[0,0.0333333333333333,0.966666666666667,0],[0.133333333333333,0.5,0.333333333333333,0.0333333333333333],[0.633333333333333,0.2,0.133333333333333,0.0333333333333333],[0.433333333333333,0.0333333333333333,0.233333333333333,0.3],[0.3,0.133333333333333,0.133333333333333,0.433333333333333],[0.266666666666667,0.166666666666667,0.1,0.466666666666667],[0.433333333333333,0.0666666666666667,0.333333333333333,0.166666666666667],[0,0,0,1],[0,0,1,0],[0.933333333333333,0,0.0666666666666667,0],[0,0,1,0],[0.133333333333333,0.333333333333333,0,0.533333333333333],[0.517241379310345,0.241379310344828,0.0344827586206897,0.206896551724138]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":96,"height":15,"xaxis":false,"yaxis":false}]},{"name":"Int11","children":[{"name":"D19B_F10_12_SANGER_5","motif":[[[0,0.111111111111111,0,0.888888888888889],[0.666666666666667,0.111111111111111,0.222222222222222,0],[0,0.888888888888889,0,0.111111111111111],[1,0,0,0],[0,0,1,0],[0,0,1,0],[0,0,0.888888888888889,0.111111111111111],[0.111111111111111,0,0,0.888888888888889],[1,0,0,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":60,"height":15,"xaxis":false,"yaxis":false},{"name":"Int3","children":[{"name":"Kr_NAR","motif":[[[0.0967741935483871,0.548387096774194,0.161290322580645,0.193548387096774],[0.354838709677419,0.129032258064516,0.32258064516129,0.193548387096774],[0.774193548387097,0,0.225806451612903,0],[0.967741935483871,0,0,0.032258064516129],[0.580645161290323,0.193548387096774,0.225806451612903,0],[0,0,1,0],[0.0645161290322581,0,0.935483870967742,0],[0.0645161290322581,0,0.935483870967742,0],[0,0.032258064516129,0.225806451612903,0.741935483870968],[0.129032258064516,0,0.161290322580645,0.709677419354839],[0.645161290322581,0.129032258064516,0.0967741935483871,0.129032258064516]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":72,"height":15,"xaxis":false,"yaxis":false},{"name":"CG12768_SANGER_5","motif":[[[0.347826086956522,0.0434782608695652,0,0.608695652173913],[0.260869565217391,0.260869565217391,0.173913043478261,0.304347826086957],[0,0.434782608695652,0,0.565217391304348],[0.0869565217391304,0.0434782608695652,0,0.869565217391304],[1,0,0,0],[0.0434782608695652,0.956521739130435,0,0],[0,1,0,0],[1,0,0,0],[1,0,0,0],[0.304347826086957,0.391304347826087,0,0.304347826086957],[0.434782608695652,0.391304347826087,0,0.173913043478261],[0.347826086956522,0.304347826086957,0,0.347826086956522]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":78,"height":15,"xaxis":false,"yaxis":false}]}]}]},{"name":"Int24","children":[{"name":"Tin_SOLEXA","motif":[[[0.110365853658537,0.343292682926829,0.210975609756098,0.335365853658537],[0.171951219512195,0.141463414634146,0.0298780487804878,0.656707317073171],[0.0341463414634146,0.419512195121951,0.0774390243902439,0.46890243902439],[0.926829268292683,0,0.0731707317073171,0],[1,0,0,0],[0,0,0.840853658536585,0.159146341463415],[0.123170731707317,0.024390243902439,0.0829268292682927,0.769512195121951],[0.400609756097561,0,0.595121951219512,0.00426829268292683]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false},{"name":"Int20","children":[{"name":"ftz_f1_SANGER_5","motif":[[[1,0,0,0],[1,0,0,0],[0,0,1,0],[0,0,1,0],[0,0,0,1],[0,1,0,0],[1,0,0,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":48,"height":15,"xaxis":false,"yaxis":false},{"name":"Int15","children":[{"name":"dl_FlyReg","motif":[[[0.0526315789473684,0.210526315789474,0.578947368421053,0.157894736842105],[0.210526315789474,0.105263157894737,0.684210526315789,0],[0.0789473684210526,0,0.894736842105263,0.0263157894736842],[0.868421052631579,0.0263157894736842,0.105263157894737,0],[0.894736842105263,0.0526315789473684,0,0.0526315789473684],[0.947368421052632,0,0.0263157894736842,0.0263157894736842],[0.631578947368421,0.0263157894736842,0.0526315789473684,0.289473684210526],[0.105263157894737,0.315789473684211,0.0789473684210526,0.5],[0.210526315789474,0.605263157894737,0.0526315789473684,0.131578947368421],[0.210526315789474,0.631578947368421,0.105263157894737,0.0526315789473684]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":66,"height":15,"xaxis":false,"yaxis":false},{"name":"Int7","children":[{"name":"Vnd_Cell","motif":[[[0.210526315789474,0,0.105263157894737,0.684210526315789],[0.0526315789473684,0.421052631578947,0.0526315789473684,0.473684210526316],[0,0,0,1],[0,0.789473684210526,0.105263157894737,0.105263157894737],[1,0,0,0],[1,0,0,0],[0,0,1,0],[0.105263157894737,0,0,0.894736842105263],[0.473684210526316,0,0.526315789473684,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":60,"height":15,"xaxis":false,"yaxis":false},{"name":"CG7386_F10_12_SANGER_5","motif":[[[0.111111111111111,0,0.888888888888889,0],[0,0,0,1],[0.222222222222222,0,0.777777777777778,0],[1,0,0,0],[1,0,0,0],[0.222222222222222,0.222222222222222,0.222222222222222,0.333333333333333],[0,0,1,0],[0.888888888888889,0.111111111111111,0,0]]],"letters":["A","C","G","T"],"color":{"A":"#00811B","C":"#2000C7","G":"#FFB32C","T":"#D00001"},"background":{"A":0.25,"C":0.25,"G":0.25,"T":0.25},"width":54,"height":15,"xaxis":false,"yaxis":false}]}]}]}]}]}]}]}]}]},"nodeRadius":2.5,"maxH":15,"maxW":156,"layout":"radialPhylog"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="docker-container-for-motifstack">docker container for motifStack<a class="anchor" aria-label="anchor" href="#docker-container-for-motifstack"></a>
</h2>
<p><a href="https://docs.docker.com/" class="external-link">Docker</a> container allows
software to be packaged into containers which can be run in any platform
using a virtual machine called boot2docker. To ease the installation of
motifStack and its depencies, we have created a docker image containing
all the components needed to run motifStack. Users can download the <a href="https://hub.docker.com/r/jianhong/motifstack/" class="external-link">motifStack
docker</a> image using the following code snippet.</p>
<pre>
cd ~ ## in windows, please try cd c:\\ Users\\ username
docker pull jianhong/motifstack:latest
mkdir tmp4motifstack ## this will be the share folder for your host and container.
docker run -ti --rm -v ${PWD}/tmp4motifstack:/volume/data jianhong/motifstack:latest bash
  In motifstack:latest docker
    1  cd /volume/data
    2  git clone https://github.com/jianhong/motifStack.documentation.git
    3  cd motifStack.documentation/
    4  cp /usr/bin/matalign app/matalign-v4a
    5  cp /usr/bin/phylip/neighbor app/neighbor.app/Contents/MacOS/neighbor
    6  R cmd -e "rmarkdown::render('suppFigure2.Rmd')"
    7  R cmd -e "rmarkdown::render('suppFigure6.Rmd')"
</pre>
<p>You will see the test.pdf file in the folder of tmp4motifstack.</p>
</div>
<div class="section level2">
<h2 id="plot-motifs-with-ggplot2">plot motifs with ggplot2<a class="anchor" aria-label="anchor" href="#plot-motifs-with-ggplot2"></a>
</h2>
<p>motifs could be plotted by <code>geom_motif</code> function.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">find.package</a></span><span class="op">(</span><span class="st">"motifStack"</span><span class="op">)</span>, </span>
<span>                            <span class="st">"extdata"</span>, <span class="st">"bin_SOLEXA.pcm"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pcm</span> <span class="op">&lt;-</span> <span class="va">pcm</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">pcm</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">pcm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"C"</span>,<span class="st">"G"</span>,<span class="st">"T"</span><span class="op">)</span></span>
<span><span class="va">markerRect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"marker"</span>, type<span class="op">=</span><span class="st">"rect"</span>, start<span class="op">=</span><span class="fl">6</span>, stop<span class="op">=</span><span class="fl">7</span>, gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>lty<span class="op">=</span><span class="fl">2</span>, fill<span class="op">=</span><span class="cn">NA</span>, col<span class="op">=</span><span class="st">"orange"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">markerLine</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"marker"</span>, type<span class="op">=</span><span class="st">"line"</span>, start<span class="op">=</span><span class="fl">3</span>, stop<span class="op">=</span><span class="fl">5</span>, gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>lwd<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">markerText</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"marker"</span>, type<span class="op">=</span><span class="st">"text"</span>, start<span class="op">=</span><span class="fl">1</span>, label<span class="op">=</span><span class="st">"*"</span>, gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">motif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"pcm"</span>, mat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">pcm</span><span class="op">)</span>, name<span class="op">=</span><span class="st">"bin_SOLEXA"</span>, </span>
<span>             markers<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">markerRect</span>, <span class="va">markerLine</span>, <span class="va">markerText</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pfm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcm-class.html">pcm2pfm</a></span><span class="op">(</span><span class="va">motif</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>xmin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="fl">.25</span><span class="op">)</span>, ymin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="fl">.75</span><span class="op">)</span>, xmax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.75</span>, <span class="fl">.75</span><span class="op">)</span>, ymax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                 fontfamily<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"serif"</span>, <span class="st">"mono"</span><span class="op">)</span>, fontface<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">motif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">pfm</span>, <span class="va">pfm</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin<span class="op">=</span><span class="va">xmin</span>, ymin<span class="op">=</span><span class="va">ymin</span>, xmax<span class="op">=</span><span class="va">xmax</span>, ymax<span class="op">=</span><span class="va">ymax</span>, motif<span class="op">=</span><span class="va">motif</span>, </span>
<span>               fontfamily<span class="op">=</span><span class="va">fontfamily</span>, fontface<span class="op">=</span><span class="va">fontface</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="../reference/geom_motif.html">geom_motif</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="motifStack_HTML_files/figure-html/geommotif-1.png" width="768"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">.5</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="fl">.75</span><span class="op">)</span>, width<span class="op">=</span><span class="fl">.5</span>, height<span class="op">=</span><span class="fl">.25</span>, </span>
<span>                 fontfamily<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"serif"</span>, <span class="st">"mono"</span><span class="op">)</span>, fontface<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">motif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">pfm</span>, <span class="va">pfm</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, width<span class="op">=</span><span class="va">width</span>, height<span class="op">=</span><span class="va">height</span>, motif<span class="op">=</span><span class="va">motif</span>, </span>
<span>               fontfamily<span class="op">=</span><span class="va">fontfamily</span>, fontface<span class="op">=</span><span class="va">fontface</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="../reference/geom_motif.html">geom_motif</a></span><span class="op">(</span>use.xy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="motifStack_HTML_files/figure-html/geommotif-2.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R Under development (unstable) (2022-11-07 r83308)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.1 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Etc/UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    grid      stats     graphics  grDevices utils     datasets </span></span>
<span><span class="co">## [8] methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] RColorBrewer_1.1-3   JASPAR2020_0.99.10   TFBSTools_1.37.0    </span></span>
<span><span class="co">##  [4] ggplot2_3.4.0        ade4_1.7-20          MotifDb_1.41.0      </span></span>
<span><span class="co">##  [7] Biostrings_2.67.0    XVector_0.39.0       GenomicRanges_1.51.1</span></span>
<span><span class="co">## [10] GenomeInfoDb_1.35.2  IRanges_2.33.0       S4Vectors_0.37.0    </span></span>
<span><span class="co">## [13] BiocGenerics_0.45.0  motifStack_1.43.0    knitr_1.40          </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] DBI_1.1.3                   bitops_1.0-7               </span></span>
<span><span class="co">##   [3] rlang_1.0.6                 magrittr_2.0.3             </span></span>
<span><span class="co">##   [5] matrixStats_0.62.0          compiler_4.3.0             </span></span>
<span><span class="co">##   [7] RSQLite_2.2.18              png_0.1-7                  </span></span>
<span><span class="co">##   [9] systemfonts_1.0.4           vctrs_0.5.0                </span></span>
<span><span class="co">##  [11] reshape2_1.4.4              stringr_1.4.1              </span></span>
<span><span class="co">##  [13] pkgconfig_2.0.3             crayon_1.5.2               </span></span>
<span><span class="co">##  [15] fastmap_1.1.0               ellipsis_0.3.2             </span></span>
<span><span class="co">##  [17] labeling_0.4.2              splitstackshape_1.4.8      </span></span>
<span><span class="co">##  [19] caTools_1.18.2              utf8_1.2.2                 </span></span>
<span><span class="co">##  [21] Rsamtools_2.15.0            rmarkdown_2.18             </span></span>
<span><span class="co">##  [23] tzdb_0.3.0                  pracma_2.4.2               </span></span>
<span><span class="co">##  [25] ragg_1.2.4                  DirichletMultinomial_1.41.0</span></span>
<span><span class="co">##  [27] purrr_0.3.5                 bit_4.0.4                  </span></span>
<span><span class="co">##  [29] xfun_0.34                   zlibbioc_1.45.0            </span></span>
<span><span class="co">##  [31] cachem_1.0.6                CNEr_1.35.0                </span></span>
<span><span class="co">##  [33] jsonlite_1.8.3              blob_1.2.3                 </span></span>
<span><span class="co">##  [35] highr_0.9                   DelayedArray_0.25.0        </span></span>
<span><span class="co">##  [37] BiocParallel_1.33.0         jpeg_0.1-9                 </span></span>
<span><span class="co">##  [39] parallel_4.3.0              R6_2.5.1                   </span></span>
<span><span class="co">##  [41] bslib_0.4.1                 stringi_1.7.8              </span></span>
<span><span class="co">##  [43] rtracklayer_1.59.0          jquerylib_0.1.4            </span></span>
<span><span class="co">##  [45] Rcpp_1.0.9                  SummarizedExperiment_1.29.1</span></span>
<span><span class="co">##  [47] base64enc_0.1-3             R.utils_2.12.1             </span></span>
<span><span class="co">##  [49] readr_2.1.3                 Matrix_1.5-1               </span></span>
<span><span class="co">##  [51] yaml_2.3.6                  codetools_0.2-18           </span></span>
<span><span class="co">##  [53] lattice_0.20-45             tibble_3.1.8               </span></span>
<span><span class="co">##  [55] plyr_1.8.7                  withr_2.5.0                </span></span>
<span><span class="co">##  [57] Biobase_2.59.0              KEGGREST_1.39.0            </span></span>
<span><span class="co">##  [59] evaluate_0.18               desc_1.4.2                 </span></span>
<span><span class="co">##  [61] pillar_1.8.1                BiocManager_1.30.19        </span></span>
<span><span class="co">##  [63] MatrixGenerics_1.11.0       grImport2_0.2-0            </span></span>
<span><span class="co">##  [65] rprojroot_2.0.3             RCurl_1.98-1.9             </span></span>
<span><span class="co">##  [67] hms_1.1.2                   munsell_0.5.0              </span></span>
<span><span class="co">##  [69] scales_1.2.1                BiocStyle_2.27.0           </span></span>
<span><span class="co">##  [71] gtools_3.9.3                xtable_1.8-4               </span></span>
<span><span class="co">##  [73] glue_1.6.2                  seqLogo_1.65.0             </span></span>
<span><span class="co">##  [75] tools_4.3.0                 TFMPvalue_0.0.9            </span></span>
<span><span class="co">##  [77] BiocIO_1.9.0                data.table_1.14.4          </span></span>
<span><span class="co">##  [79] BSgenome_1.67.1             annotate_1.77.0            </span></span>
<span><span class="co">##  [81] GenomicAlignments_1.35.0    fs_1.5.2                   </span></span>
<span><span class="co">##  [83] XML_3.99-0.12               poweRlaw_0.70.6            </span></span>
<span><span class="co">##  [85] AnnotationDbi_1.61.0        colorspace_2.0-3           </span></span>
<span><span class="co">##  [87] GenomeInfoDbData_1.2.9      restfulr_0.0.15            </span></span>
<span><span class="co">##  [89] cli_3.4.1                   textshaping_0.3.6          </span></span>
<span><span class="co">##  [91] fansi_1.0.3                 gtable_0.3.1               </span></span>
<span><span class="co">##  [93] R.methodsS3_1.8.2           sass_0.4.2                 </span></span>
<span><span class="co">##  [95] digest_0.6.30               rjson_0.2.21               </span></span>
<span><span class="co">##  [97] htmlwidgets_1.5.4           R.oo_1.25.0                </span></span>
<span><span class="co">##  [99] memoise_2.0.1               htmltools_0.5.3            </span></span>
<span><span class="co">## [101] pkgdown_2.0.6               lifecycle_1.0.3            </span></span>
<span><span class="co">## [103] httr_1.4.4                  GO.db_3.16.0               </span></span>
<span><span class="co">## [105] bit64_4.0.5                 MASS_7.3-58.1</span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<div id="refs" class="references csl-bib-body" line-spacing="2">
<div id="ref-Oliver2006" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">Bembom, O. seqLogo: Sequence logos for DNA
sequence alignments. <em>R package version 1.5.4</em> (2006).</div>
</div>
<div id="ref-foat2006statistical" class="csl-entry">
<div class="csl-left-margin">2. </div>
<div class="csl-right-inline">Foat, B. C., Morozov, A. V. &amp; Bussemaker,
H. J. Statistical mechanical modeling of genome-wide transcription
factor occupancy data by MatrixREDUCE. <em>Bioinformatics</em>
<strong>22,</strong> e141–e149 (2006).</div>
</div>
<div id="ref-Eloi2010" class="csl-entry">
<div class="csl-left-margin">3. </div>
<div class="csl-right-inline">Mercier, E. &amp; Gottardo, R. MotIV: Motif
identification and validation. <em>R package version 1.10.0</em>
(2010).</div>
</div>
<div id="ref-Mahony2007" class="csl-entry">
<div class="csl-left-margin">4. </div>
<div class="csl-right-inline">S,
M. &amp; PV, B. STAMP: A web tool for exploring DNA-binding motif
similarities. <em>Nucleic Acids Res.</em> <strong>35(Web Server
issue),</strong> W253–W258 (2007).</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jianhong Ou, Lihua Julie Zhu Developer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
